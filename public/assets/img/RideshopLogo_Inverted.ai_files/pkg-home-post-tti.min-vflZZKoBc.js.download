define("modules/clean/cloud_docs/home_create_file_experiments_post_tti",["require","exports","tslib","react","modules/clean/cloud_docs/constants","modules/clean/react/new_file_menu/new_file_menu","modules/clean/react/browse/constants","modules/clean/react/home/modals/async_home_modals","modules/clean/react/home/store"],(function(e,t,n,a,o,i,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.getCloudDocsExperiments=function(){return{expGddCreate:!1,expPaperCreate:!1,expBinderCreate:!1}};var c=function(e,t){return function(a){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){return s.asyncShowNewFolderModal({user:e,initialPath:a,origin:r.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_CREATE_FILE_MODAL,redirectOnClose:t}),[2]}))}))}};t.getNewFileMenu=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,s,u;return n.__generator(this,(function(n){return t=e.cloudDocsExperiments.expGddCreate,r=e.cloudDocsExperiments.expPaperCreate,s=e.cloudDocsExperiments.expBinderCreate,u=function(){return a.default.createElement(i.NewFileMenu,{key:"new-file-menu",user:l.getUser(),disabled:!1,showGdd:t,showPaper:r,showBinder:s,source:o.NewFileMenuFromType.HOME,handleClickNewFolder:c})},[2,new Promise((function(e,t){e(u)}))]}))}))}})),define("modules/clean/react/home/content_suggestions/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/home/content_suggestions/constants"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedActions={dispatchLoaded:function(e){n.Dispatcher.dispatch({type:a.SuggestedResourceActionTypes.LOAD_SUCCESS,items:e})}}})),define("modules/clean/react/home/content_suggestions/actions_post_tti",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/content_suggestions/constants","modules/clean/react/home/content_suggestions/api_post_tti","modules/clean/react/starred/id_type_pair","modules/clean/react/home/content_suggestions/api","modules/clean/react/home/content_suggestions/api_post_tti","modules/clean/react/home/content_suggestions/actions","modules/clean/react/home/resource/api_post_tti","modules/clean/react/home/resource_id_types","modules/clean/react/home/store","modules/clean/react/home/constants"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.dismissSuggestedItem=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,i.dismissSuggestedItem(e,t,r)];case 1:return n.sent(),a.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS,dismissed:t}),[3,3];case 2:return n.sent(),a.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE,dismissed:t}),[3,3];case 3:return[2]}}))}))},t.loadItems=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){var r,u,d;return n.__generator(this,(function(n){switch(n.label){case 0:r=[],n.label=1;case 1:return n.trys.push([1,3,,4]),[4,l.getSuggested(e,t,i)];case 2:return u=n.sent(),(d=s.handlePayload(u))&&c.SuggestedActions.dispatchLoaded(d.items),[2,d];case 3:return n.sent(),a.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.LOAD_FAILURE}),[2,r];case 4:return[2]}}))}))},t.fetchSuggestedFileMetadata=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,o,i;return n.__generator(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){return{id:e.resourceId,type:d.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID}})),[4,u.getFileMetadata(m.getUser(),t)];case 1:return o=n.sent(),i={},o.forEach((function(e){return i[r.idTypePairToString(e)]=e.file_metadata})),a.Dispatcher.dispatch({type:_.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:i}),[2]}}))}))}})),define("modules/clean/react/home/content_suggestions/api",["require","exports","tslib","external/lodash","modules/core/exception","modules/clean/react/home/constants"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.handlePayload=function(e){return{items:e?a.compact(e.suggested_items.map((function(e){return(t=e)[".tag"]===i.SuggestItemTypes.FILE?{resourceId:(n=t).resource_id,encodedFileObjId:n.resource_id,key:n.resource_id,fqPath:n.fq_path,filename:n.filename,reason:n.reason,displayType:n.display_type[".tag"].toUpperCase(),isStarred:n.is_starred,breadcrumb:n.breadcrumb,url:n.url,suggestId:n.prediction_id,predictionId:n.prediction_id,isDismissed:!1,thumbnailUrl:n.thumbnail_url,isDir:n.is_dir,type:i.SuggestItemTypes.FILE}:t[".tag"]===i.SuggestItemTypes.PAPER_DOCUMENT?{resourceId:(n=t).resource_id,key:n.resource_id,reason:n.reason,displayType:n.display_type[".tag"].toUpperCase(),isStarred:n.is_starred,breadcrumb:n.breadcrumb,url:n.url,suggestId:n.prediction_id,predictionId:n.prediction_id,isDismissed:!1,thumbnailUrl:n.thumbnail_url,type:i.SuggestItemTypes.PAPER_DOCUMENT}:(o.reportStack("Unknown suggested item type",{severity:o.SEVERITY.NONCRITICAL,exc_extra:t}),null);var t,n}))):null,variant:e.variant}}})),define("modules/clean/react/home/content_suggestions/api_post_tti",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.ACCEPTED_SUGGEST_ITEM_TYPES=[{".tag":"file"},{".tag":"paper_document"},{".tag":"other"}],t.getClient=a.once((function(){return new o.UserApiV2Client})),t.dismissSuggestedItem=function(e,n,a){var o=n.id,i=n.type;return t.getClient().ns("suggest").rpc("dismiss_suggested_item",{resource_id:o,id_type:i,feature_name:a},{subjectUserId:e.id})},t.getSuggested=function(e,a,o){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){return[2,t.getClient().ns("suggest").rpc("get_suggested_v2",{variant:a,num_items:o,accepted_types:t.ACCEPTED_SUGGEST_ITEM_TYPES,client_type:{".tag":"web_home"}},{subjectUserId:e.id})]}))}))}})),define("modules/clean/react/home/content_suggestions/constants",["require","exports","modules/core/i18n","modules/clean/filetypes"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.LOAD_SUCCESS="HOME_SUGGESTED_LOAD_SUCCESS",e.LOAD_FAILURE="HOME_SUGGESTED_LOAD_FAILURE",e.DISMISS_ITEM_SUCCESS="HOME_SUGGESTED_DISMISS_ITEM_SUCCESS",e.DISMISS_ITEM_FAILURE="HOME_SUGGESTED_DISMISS_ITEM_FAILURE"})(t.SuggestedResourceActionTypes||(t.SuggestedResourceActionTypes={})),(function(e){e.UNKNOWN="UNKNOWN",e.RECENCY="RECENCY",e.FRECENCY="FRECENCY",e.WEEKLY_PERIODICITY="WEEKLY_PERIODICITY",e.EVENT_COUNT="EVENT_COUNT",e.EDIT_COUNT="EDIT_COUNT",e.VIEW_COUNT="VIEW_COUNT",e.PREDICTION="PREDICTION",e.PREDICTION_VIEW="PREDICTION_VIEW",e.PREDICTION_EDIT="PREDICTION_EDIT",e.PREDICTION_SHARE="PREDICTION_SHARE",e.WEEKLY_FRECENCY="WEEKLY_FRECENCY",e.DIR_WEEKLY_FRECENCY="DIR_WEEKLY_FRECENCY",e.RECENT_SHARE="RECENT_SHARE"})(t.SUGGEST_REASONS||(t.SUGGEST_REASONS={})),t.LoggingTypes={OPEN_SUGGESTED_ITEM:"open_suggested_item",OPEN_PARENT_FOLDER:"open_parent_folder",RENDERED_SUGGESTED_ITEM:"rendered_suggested_item",CLICK_ADD_TO_STARRED:"click_add_to_starred",CLICK_DISMISS_SUGGESTED_ITEM:"click_dismiss_suggested_item",CANCEL_DISMISS_SUGGESTED_ITEM:"cancel_dismiss_suggested_item",DISMISS_SUGGESTED_ITEM:"dismiss_suggested_item",LIKE_SUGGESTED_ITEM:"like_suggested_item",SUGGESTED_SECTION_SHOWN:"suggested_section_shown",THUMBNAIL_LOADED:"thumbnail_loaded",THUMBNAIL_ERROR:"thumbnail_error",HIDE_SECTION:"hide_section",UNHIDE_SECTION:"unhide_section",CLICK_INFO_ICON:"click_info_icon"},t.DismissReasonToText={old:n.intl.formatMessage({id:"yZn8iM",defaultMessage:"I don’t need this file right now."}),privacy:n.intl.formatMessage({id:"JDlenX",defaultMessage:"It’s inappropriate."}),nonsense:n.intl.formatMessage({id:"bqyLa4",defaultMessage:"This suggestion doesn’t make sense."}),disliked:n.intl.formatMessage({id:"FsmDQI",defaultMessage:"I don’t like suggestions."}),other:n.intl.formatMessage({id:"bmpvII",defaultMessage:"Other"}),no_selection:n.intl.formatMessage({id:"im2GDs",defaultMessage:"Please select a reason."})},t.DismissReasonList=["old","privacy","nonsense","disliked","other"],t.DisplayTypeToFileType={DOC:a.FileTypes.FILE,MSDOC:a.FileTypes.FILE,PDF:a.FileTypes.FILE,SPREADSHEET:a.FileTypes.FILE,FILE:a.FileTypes.FILE,FOLDER:a.FileTypes.FOLDER,SHARED_FOLDER:a.FileTypes.SHARED_FOLDER,TEAM_FOLDER:a.FileTypes.TEAM_SHARED_FOLDER,CDM_TEAM_MEMBER_FOLDER:a.FileTypes.TEAM_MEMBER_FOLDER,TEAM_MEMBER_FOLDER:a.FileTypes.TEAM_MEMBER_FOLDER,SHARED_FOLDER_READ_ONLY:a.FileTypes.SHARED_FOLDER,TEAM_READ_ONLY:a.FileTypes.TEAM_SHARED_FOLDER,RESTRICTED_FOLDER:a.FileTypes.FOLDER,CAMERA_UPLOADS:a.FileTypes.FOLDER},t.FileTypeToIcon=function(e){switch(e){case a.FileTypes.TEAM_MEMBER_FOLDER:return"folder_team_member";default:return""}}})),define("modules/clean/react/home/content_suggestions/home_suggest",["require","exports","tslib","classnames","react","modules/clean/js_client_stopwatch","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/react/home/actions_post_tti","modules/clean/react/home/constants","modules/clean/react/home/content_suggestions/actions_post_tti","modules/clean/react/home/content_suggestions/grid_layout","modules/clean/react/home/content_suggestions/home_suggest_empty_state","modules/clean/react/home/content_suggestions/home_suggest_frame","modules/clean/react/home/content_suggestions/loading","modules/clean/react/home/content_suggestions/suggested_file_card","modules/clean/react/home/content_suggestions/suggested_resource_store","modules/clean/react/home/content_suggestions/util/logging/home_suggest_logger","modules/clean/react/home/store"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),t.initPrefetch=function(){};var v=(function(e){function t(t){var a=e.call(this,t)||this;return a.numItemsLastLogged=0,a.onStoreUpdate=function(){return a.setState(a.getStateFromStore())},a.onChangeSuggestVisibility=function(){var e=!a.props.isHiddenByUser;s.setSectionVisibilityPostTTI(h.getUserId(),{".tag":"suggest"},!e),f.homeSuggestLogger.logShowHideSection(l.HomeSections.SUGGEST,e)},a.removeSuggestionFromUi=function(e){return function(){e.isDismissed&&a.setState({dismissedSuggestionKeys:n.__spreadArrays(a.state.dismissedSuggestionKeys,[e.key])})}},a.store=g.getSuggestedResourceStore(t.homeAvailabilityLogger),a.featureVariant=a.store.getFeatureVariant(),a.removeStoreListener=a.store.addListener(a.onStoreUpdate),a.thumbStore=new r.BufferedThumbStore,a.state=n.__assign(n.__assign({},a.getStateFromStore()),{dismissedSuggestionKeys:[]}),a.loggedItems={},i.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),a}return n.__extends(t,e),t.prototype.getStateFromStore=function(){var e=this.store.getItems();return{loadingState:this.store.getLoadingState(),suggested:e}},t.prototype.UNSAFE_componentWillMount=function(){var e=h.getHomeStore().getUser();this.store.getLoadingState()===l.LoadingStates.FAILURE&&c.loadItems(e,this.featureVariant,10)},t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener()},t.prototype.renderSuggestContainer=function(e,t,i){var r=this;if(e)return null;var s=this.state.suggested.filter((function(e){return!r.state.dismissedSuggestionKeys.includes(e.key)})).slice(0,t),c=s.filter((function(e){return!e.isDismissed})).length;if(this.state.loadingState!==l.LoadingStates.SUCCESS&&0===c)return o.default.createElement(_.SuggestedLoadingInner,n.__assign({},this.props));if(0===t||0===c)return o.default.createElement(d.SuggestEmptyState,null);if(this.numItemsLastLogged!==t){var u=[];s.forEach((function(e){r.loggedItems[e.resourceId]||(u.push(e),r.loggedItems[e.resourceId]=!0)})),f.homeSuggestLogger.logRenderedSuggestedItems(u),f.homeSuggestLogger.logSuggestedShown(s.length,this.featureVariant,t),this.numItemsLastLogged=t}var m=a.default({"home-access-section__content":!0,"home__suggest-items":!0});return o.default.createElement("div",{className:a.default(m)},this.renderSuggestedItems(s,i))},t.prototype.renderSuggestedItems=function(e,t){var n=this;return e.map((function(e,i){return e.type===l.SuggestItemTypes.FILE?o.default.createElement("div",{className:a.default({"home__suggest-items-hidden":e.isDismissed}),onAnimationEnd:n.removeSuggestionFromUi(e)},o.default.createElement(p.SuggestedFileCard,{suggested:e,feature:l.SUGGEST_GRID_FEATURE,position:i,key:e.key,tileWidth:t,thumbStore:n.thumbStore})):null}))},t.prototype.render=function(){if(!this.props.canRenderItems)return null;var e=this.props,t=e.containerWidth,n=e.isHiddenByUser,a=u.getLayout(t),i=a.itemsToShow,r=a.tileWidth;return o.default.createElement(m.SuggestFrame,{isHiddenByUser:n},o.default.createElement(m.SuggestHeader,{isHiddenByUser:n,buttonAction:this.onChangeSuggestVisibility}),this.renderSuggestContainer(n,i,r))},t.displayName="HomeSuggest",t})(o.default.PureComponent);t.HomeSuggest=v,t.RootComponent=function(e){return o.default.createElement(v,n.__assign({},e))}})),define("modules/clean/react/home/content_suggestions/home_suggest_empty_state",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/home/util/empty"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.SuggestEmptyState=function(){return a.default.createElement(i.SectionEmptyText,{message:o.intl.formatMessage({id:"RVB4pC",defaultMessage:"As you use Dropbox, suggested items will automatically show up here."}),learnMoreLink:"/help/desktop-web/homepage#suggest"})}})),define("modules/clean/react/home/content_suggestions/logger_api",["require","exports","tslib","external/lodash","modules/core/exception","modules/clean/web_timing_logger","modules/clean/react/home/api"],(function(e,t,n,a,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),r=n.__importStar(r);var s={},l={},c=function(e,t,n){r.makeRequest({url:n,type:"POST",data:{role:t,activities_json:JSON.stringify(a.map(e,"json")),send_ts:Date.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0}).then((function(){return e.forEach((function(e){return e.resolve()}))}),(function(){return e.forEach((function(e){return e.reject()}))}))},u=a.throttle((function(){a.size(s)>1&&o.reportStack("Multiple role activities",{severity:o.SEVERITY.NONCRITICAL,exc_extra:s}),Object.keys(s).forEach((function(e){var t=s[e];c(t,e,"/home_feed/log_activities")})),s={},Object.keys(l).forEach((function(e){var t=l[e];c(t,e,"/home_feed/log_suggested_activities")})),l={}}),1e3,{leading:!0,trailing:!0});t.logHomeActivity=function(e){var t=e.role,r=e.eventName,c=e.extra,d=e.suggestId,m=e.table;return new Promise((function(e,_){return n.__awaiter(void 0,void 0,void 0,(function(){var p,g,f,h;return n.__generator(this,(function(v){switch(v.label){case 0:switch(m||(m="home_activity"),p={json:{event_name:r,event_time:Date.now(),extra:a.mapValues(c||{},(function(e){return String(e)}))},resolve:e,reject:_},m){case"home_activity":s[t]=s[t]||[],s[t].push(p);break;case"home_suggest":s[t]=s[t]||[],g=p.json,f=n.__rest(p,["json"]),h=n.__assign({json:n.__assign({},g)},f),s[t].push(h),p.json.suggest_id=d,l[t]=l[t]||[],l[t].push(p);break;default:return o.reportStack("Unknown logging table specified",{severity:o.SEVERITY.NONCRITICAL,exc_extra:{table:m,role:t,eventName:r,extra:c,suggestId:d}}),[2]}return[4,i.waitForTTI()];case 1:return v.sent(),u(),[2]}}))}))}))}})),define("modules/clean/react/home/content_suggestions/models/suggested_item",["require","exports","modules/clean/filetypes","modules/clean/react/home/content_suggestions/constants","modules/clean/react/starred/constants"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.suggestedItemToIdTypePair=function(e){return null===e.encodedFileObjId||void 0===e.encodedFileObjId?{id:e.fqPath,type:o.IdTypes.FQ_PATH}:{id:e.encodedFileObjId,type:o.IdTypes.ENCODED_FILE_OBJ_ID}},t.suggestedItemToFileIconFields=function(e){var t,o=(t=e.displayType,a.DisplayTypeToFileType[t]||n.FileTypes.FILE);return{type:o,icon:a.FileTypeToIcon(o),fq_path:e.fqPath,thumbnail_url_tmpl:e.thumbnailUrl,isDeleted:!1}}})),define("modules/clean/react/home/content_suggestions/suggested_file_card",["require","exports","tslib","react","dig-components/buttons","dig-components/tooltips","dig-components/icons","dig-components/icons/src","modules/clean/browse_uri_interface","modules/clean/em_string","modules/clean/filetypes","modules/clean/react/css","modules/clean/react/files_view/file_thumbnail","modules/clean/react/home/constants","modules/clean/react/home/content_suggestions/actions_post_tti","modules/clean/react/home/content_suggestions/models/suggested_item","modules/clean/react/home/content_suggestions/util/logging/home_suggest_logger","modules/clean/react/home/resource/actions_post_tti","modules/clean/react/home/store","modules/clean/react/home/util/logging/availability_logger_common","modules/clean/navigation","modules/clean/react/icon/folder_icon","modules/clean/react/snackbar","modules/clean/viewer","modules/core/i18n"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h,v,E,y,S,T,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a);var D={type:u.FileTypes.FOLDER,icon:"folder"},C=(function(e){function t(t){var n=e.call(this,t)||this;return n.cardRef=a.default.createRef(),n.onDismissItemClick=function(e){e.stopPropagation(),e.preventDefault();var t=n.props,a=t.feature,o=t.position,i=t.suggested;f.homeSuggestLogger.logClickDismissSuggestedItem(i,E.withHomePrefix(_.HomeSections.SUGGEST),"dismiss-suggested-item",o);var r=g.suggestedItemToIdTypePair(i);p.dismissSuggestedItem(n.user,r,a).then((function(){f.homeSuggestLogger.logDismissSuggestedItem(i,E.withHomePrefix(_.HomeSections.SUGGEST),"dismiss-suggested-item",o,"no_feedback_modal")})).catch((function(){var e,t=i.filename;e=t?b.intl.formatMessage({id:"YmEqih",defaultMessage:"There was a problem dismissing {item_name}"},{item_name:t}):b.intl.formatMessage({id:"rBSlLP",defaultMessage:"There was a problem dismissing your selection"}),T.Snackbar.fail(e,"content-suggestions")}))},n.onParentFolderClick=function(e){e.stopPropagation(),e.preventDefault();var t=v.getUser(),a=n.props,o=a.suggested,i=a.position,r=o.breadcrumb.length?o.breadcrumb[0]:null,s=r?r.url:l.browse_uri_for_fq_path(t,"").toString();if(s){var c=y.isMetaKeyPressed(e)?y.NavigationMethod.NEW_TAB:y.NavigationMethod.REDIRECT;y.logAndNavigate(s,(function(e,t,n){return function(){return f.homeSuggestLogger.logOpenParentFolder(t,E.withHomePrefix(_.HomeSections.SUGGEST),e,n)}})("parent-folder",o,i),c)}},n.onFilenameClick=function(e){e.preventDefault(),e.stopPropagation(),n.handleNavigation(e,"title")},n.onFileThumbnailClick=function(e){e.preventDefault(),e.stopPropagation(),n.handleNavigation(e,"icon")},n.onFileThumbnailKeyPress=function(e){e.target===n.cardRef.current&&"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),n.handleNavigation(e,"icon"))},n.handleNavigation=function(e,t){var a=n.props,o=a.suggested,i=(function(e,t,n){return function(){return f.homeSuggestLogger.logOpenSuggestedItem(t,E.withHomePrefix(_.HomeSections.SUGGEST),e,n)}})(t,o,a.position);if(y.isMetaKeyPressed(e)){var r=o.displayType===_.EXTERNAL_RESOURCE_TYPE?y.NavigationMethod.UNSAFE_NEW_TAB:y.NavigationMethod.NEW_TAB;y.logAndNavigate(o.url,i,r)}else _.PreviewableDisplayTypes.includes(o.displayType)?h.openInFileViewer("ENCODED_FILE_OBJ_ID:"+o.encodedFileObjId,i):y.logAndNavigate(o.url,i,y.NavigationMethod.REDIRECT)},n.user=v.getUser(),n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.suggested,n=e.thumbStore,o=e.tileWidth,i=g.suggestedItemToFileIconFields(t),r=t.breadcrumb.length?t.breadcrumb[0]:null,s=r?r.name:I.Viewer.get_root_name(this.user),c=r?r.url:l.browse_uri_for_fq_path(this.user,"").toString(),u=t.fqPath.split("/");return u.pop(),a.default.createElement("div",{className:"home__suggest_card",tabIndex:0,"aria-label":t.filename,role:"group",onClick:this.onFileThumbnailClick,onKeyPress:this.onFileThumbnailKeyPress,ref:this.cardRef},a.default.createElement("a",{className:"home__suggest_image",href:t.url,tabIndex:-1,onClick:this.onFileThumbnailClick,style:{width:o},"aria-hidden":"true"},a.default.createElement(m.FileThumbnail,{file:i,thumbStore:n,thumbnailSize:256,iconSize:72,key:t.key})),a.default.createElement(M,{onClick:this.onDismissItemClick}),a.default.createElement("div",{className:"home__suggest_details",style:{maxWidth:o}},a.default.createElement(A,{filename:t.filename,url:t.url,onClick:this.onFilenameClick}),a.default.createElement("div",{className:"home__suggest_subheader"},a.default.createElement(S.FolderIcon,{file:D,className:"home__suggest_subheader-icon","aria-hidden":"true"}),a.default.createElement(w,{folderName:s,folderPathArray:u,folderUrl:c,onClick:this.onParentFolderClick}))))},t.displayName="SuggestedFileCard",t})(a.default.PureComponent);t.InternalSuggestedFileCard=C,t.SuggestedFileCard=d.requireCssWithComponent(C,["/static/css/dig-components/index.web-vflyKkT3N.css"]);var A=function(e){var t=e.filename,n=e.onClick,o=e.url,r=c.Emstring.em_snippet(t,14,.5),s=a.default.createElement("a",{className:"home__suggest_filename",href:o,onClick:n},r);return t!==r?a.default.createElement(i.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-filename-tooltip",title:t,placement:"top"},s):s};t.SuggestedFileCardFilename=A;var w=function(e){var t=e.folderName,n=e.folderPathArray,o=e.folderUrl,r=e.onClick,s=c.Emstring.em_snippet(t,10,.5),l=a.default.createElement("a",{className:"home__suggest_subheader-label",href:o,onClick:r},s);return n.length>2?a.default.createElement(i.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-v2-foldername-tooltip",title:n.join("/"),placement:"bottom"},l):t!==s?a.default.createElement(i.Tooltip,{className:"home__suggest-v2_tooltip",id:"suggested-file-card-v2-foldername-tooltip",title:t,placement:"bottom"},l):l};t.SuggestedFileCardSubheaderLabel=w;var M=function(e){return a.default.createElement(o.IconButton,{variant:"transparent",className:"home__suggest_dismiss",onClick:e.onClick},a.default.createElement(r.UIIcon,{src:s.CloseLine,"aria-label":b.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"})}))};t.SuggestedFileCardDismissButton=M})),define("modules/clean/react/home/content_suggestions/suggested_resource_store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/flux/flux_store","modules/clean/react/home/content_suggestions/constants","modules/clean/react/home/content_suggestions/actions","modules/clean/react/home/content_suggestions/api","modules/clean/react/home/content_suggestions/actions_post_tti","modules/clean/react/home/store"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(t){var n=e.call(this,a.Dispatcher)||this;n.items=[],n.loadingState=o.LoadingStates.LOADING;var i=!1;return t.handlePrefetch(o.HomePrefetchTypes.GET_SUGGESTED,(function(e){var t=l.handlePayload(e),o=t.items;n.usedVariant=t.variant,o?i?s.SuggestedActions.dispatchLoaded(o):n.onItemsLoadSuccess(o):i?a.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.LOAD_FAILURE}):n.onItemsLoadFailure()})),i=!0,n}return n.__extends(t,e),t.prototype.getItems=function(){return this.items},t.prototype.getLoadingState=function(){return this.loadingState},t.prototype.getFeatureVariant=function(){if(!this.featureVariant){var e=u.getHomeStore().getActiveVariant(o.SUGGEST_GRID_FEATURE).toLowerCase();this.featureVariant=o.SUGGEST_GRID_FEATURE+":"+e}return this.featureVariant},t.prototype.getUsedVariant=function(){return this.usedVariant},t.prototype.onItemsLoadSuccess=function(e){this.items=e,this.loadingState=o.LoadingStates.SUCCESS,e&&c.fetchSuggestedFileMetadata(e)},t.prototype.onItemsLoadFailure=function(){this.loadingState=o.LoadingStates.FAILURE},t.prototype.onDismissItemSuccess=function(e){this.loadingState=o.LoadingStates.LOADING,this.items=this.items.map((function(t){return"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?n.__assign(n.__assign({},t),{isDismissed:!0}):t})),this.loadingState=o.LoadingStates.SUCCESS},t.prototype.onDismissItemFailure=function(e){this.loadingState=o.LoadingStates.LOADING,this.items=this.items.map((function(t){return"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?n.__assign(n.__assign({},t),{isDismissed:!1}):t})),this.loadingState=o.LoadingStates.SUCCESS},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case r.SuggestedResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items),this.__emitChange();break;case r.SuggestedResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(),this.__emitChange();break;case r.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS:this.onDismissItemSuccess(t.dismissed),this.__emitChange();break;case r.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE:this.onDismissItemFailure(t.dismissed),this.__emitChange()}},t})(i.FluxStore);t.PrivateSuggestedResourceStoreClass=d;var m=null;t.getSuggestedResourceStore=function(e){return null===m&&(m=new d(e)),m}})),define("modules/clean/react/home/content_suggestions/util/logging/home_suggest_logger",["require","exports","tslib","external/lodash","modules/clean/react/home/content_suggestions/logger_api","modules/clean/react/home/store","modules/clean/react/home/content_suggestions/constants"],(function(e,t,n,a,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a);var s=(function(){function e(){}return e.prototype.logOpenSuggestedItem=function(e,t,n,a){return o.logHomeActivity({eventName:r.LoggingTypes.OPEN_SUGGESTED_ITEM,role:i.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:a,clickOrigin:n,source:t,isDir:e.isDir}})},e.prototype.logOpenParentFolder=function(e,t,n,a){return o.logHomeActivity({eventName:r.LoggingTypes.OPEN_PARENT_FOLDER,role:i.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:a,clickOrigin:n,source:t,isDir:e.isDir}})},e.prototype.logClickDismissSuggestedItem=function(e,t,n,a){return o.logHomeActivity({eventName:r.LoggingTypes.CLICK_DISMISS_SUGGESTED_ITEM,role:i.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:a,clickOrigin:n,source:t,isDir:e.isDir}})},e.prototype.logDismissSuggestedItem=function(e,t,n,a,s){o.logHomeActivity({eventName:r.LoggingTypes.DISMISS_SUGGESTED_ITEM,role:i.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:a,clickOrigin:n,source:t,reason:s,isDir:e.isDir}})},e.prototype.logSuggestedShown=function(e,t,n){o.logHomeActivity({eventName:r.LoggingTypes.SUGGESTED_SECTION_SHOWN,role:i.getHomeStore().getRole(),table:"home_suggest",extra:{num_items:e,variant:t,items_shown:n}})},e.prototype.logShowHideSection=function(e,t){o.logHomeActivity({eventName:t?r.LoggingTypes.HIDE_SECTION:r.LoggingTypes.UNHIDE_SECTION,role:i.getHomeStore().getRole(),table:"home_suggest",extra:{section_name:e}})},e.prototype.logRenderedSuggestedItems=function(e){var t=i.getHomeStore().getRole(),n=a.map(e,(function(e,n){return o.logHomeActivity({eventName:r.LoggingTypes.RENDERED_SUGGESTED_ITEM,role:t,suggestId:e.suggestId,table:"home_suggest",extra:{index:n,isDir:e.isDir}})}));Promise.all(n)},e.prototype.logThumbnailStatus=function(e,t,a,s,l){var c=s?r.LoggingTypes.THUMBNAIL_ERROR:r.LoggingTypes.THUMBNAIL_LOADED;o.logHomeActivity({eventName:c,role:i.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:n.__assign({index:a},l)})},e})();t.HomeSuggestLogger=s,t.withHomePrefix=function(e){return"home_"+e},t.homeSuggestLogger=new s})),define("modules/clean/react/home/post_tti/interface",["require","exports","modules/clean/react/home/resource/actions_post_tti","modules/clean/react/home/starred/actions_post_tti","modules/clean/react/home/roots/home_access_web_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/recents/components/recent_activity_container_post_tti","modules/clean/react/home/recents/recent_activity_starred_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/react/home/recents/components/attachment_list_view_post_tti","modules/clean/sharing/async_share_modal_util","modules/clean/react/home/api_post_tti","modules/clean/react/home/post_tti/props_post_tti","modules/clean/react/home/util/feedback_button","modules/clean/react/home/util/logging/availability_logger_post_tti","modules/clean/react/home/recents/recent_activity_client_post_tti","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/starred/actions_post_tti","modules/clean/cloud_docs/home_create_file_experiments_post_tti","modules/clean/react/extensions/client","modules/clean/react/home/recents/recent_activity_file_action_post_tti","modules/clean/react/home/starred/starred_item_file_action_post_tti","modules/clean/react/home/content_suggestions/home_suggest","modules/clean/upsell/home_inline_location","spectrum/dimensions","modules/clean/react/home/surface_teams_homepage/home_teams","modules/clean/react/home/recommended_members/recommended_members_post_tti","modules/clean/react/plusplus/file_actions"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h,v,E,y,S,T,I,b,D,C,A,w,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openInFileViewer=n.openInFileViewer,t.createAutoShareLink=n.createAutoShareLink,t.getStarredStatusMetadata=a.getStarredStatusMetadata,t.homeAccessWebComponentDidMount=o.homeAccessWebComponentDidMount,t.openFile=i.openFile,t.downloadFiles=i.downloadFiles,t.openVersions=i.openVersions,t.shareFile=i.shareFile,t.previewFileSyncRecentItem=i.previewFileSyncRecentItem,t.deleteRecentItem=i.deleteRecentItem,t.deleteAttachments=r.deleteAttachments,t.getUnityFeatures=s.getUnityFeatures,t.recentActivityContainerComponentDidMount=l.recentActivityContainerComponentDidMount,t.setStarredStatusOfPaperRecentItems=c.setStarredStatusOfPaperRecentItems,t.fetchStarredStatus=c.fetchStarredStatus,t.ensureAttachments=u.ensureAttachments,t.loadPaperRecentItems=u.loadPaperRecentItems,t.loadRecentItems=u.loadRecentItems,t.AttachmentListView=d.AttachmentListView,t.asyncShowShareModal=m.asyncShowShareModal,t.createPaperDoc=_.createPaperDoc,t.setSectionVisibility=_.setSectionVisibility,t.getPostTTIProps=p.getPostTTIProps,t.FeedbackButton=g.FeedbackButton,t.logHomeAvailability=f.logHomeAvailability,t.archivePaperResources=h.archivePaperResources,t.postLogEvent=h.postLogEvent,t.logOpenPathUrl=v.logOpenPathUrl,t.openUrl=v.openUrl,t.logRequestFailed=v.logRequestFailed,t.logRecentsLoaded=v.logRecentsLoaded,t.logViewInFolder=v.logViewInFolder,t.loadAllStarredItems=E.loadAllStarredItems,t.getNewFileMenu=y.getNewFileMenu,t.getExtensionsClient=S.getExtensionsClient,t.RecentActivityFileActionPost=T.RecentActivityFileActionPost,t.StarredItemFileActionPost=I.StarredItemFileActionPost,t.HomeSuggest=b.HomeSuggest,t.initPrefetch=b.initPrefetch,t.HomeInlineContentPrompt=D.HomeInlineContentPrompt,t.initPrefetchHomeInlineContentPrompt=D.initPrefetchHomeInlineContentPrompt,t.Dimensions=C.Dimensions,t.HomeTeams=A.HomeTeams,t.initPrefetchHomeTeams=A.initPrefetchHomeTeams,t.RecommendedMembers=w.RecommendedMembers,t.initPrefetchRecommendedMembers=w.initPrefetchRecommendedMembers,t.handleLinkNodeAction=M.handleLinkNodeAction,t.getLinkNodeEventObject=M.getLinkNodeEventObject})),define("modules/clean/react/home/post_tti/props_post_tti",["require","exports","modules/clean/cloud_docs/home_create_file_experiments_post_tti","modules/clean/react/home/util/prefetch_handler","modules/core/exception","external/lodash"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPostTTIProps=i.once((function(){return new Promise((function(e){var t=a.getPrefetchHandler("__REGISTER_POST_TTI_PREFETCH_HANDLER"),i=function(){return e({renderSnapEngage:!1,maybeRenderTeamAdminModals:!1,permissionsAtUploadModalProps:{autoTeamGroupId:""},uploaderPostTTIExperiments:{},cloudDocsExperiments:n.getCloudDocsExperiments(),montanaModalProps:null,preferredEditors:{},showLegacyCreatePaperButton:!1})};t?a.handlePrefetch(t,(function(t){try{e(JSON.parse(t))}catch(e){o.reportStack("Failed to parse post TTI props",{severity:o.SEVERITY.CRITICAL,exc_extra:{error:e}}),i()}}),(function(e){o.reportStack("Post TTI prefetch failed",{severity:o.SEVERITY.CRITICAL,exc_extra:{error:e}}),i()})):i()}))}))})),define("modules/clean/react/home/post_tti/unity_post_tti",["require","exports","tslib"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnityFeatures=function(){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,new Promise((function(t,n){e(["modules/clean/unity/features"],t,n)})).then(n.__importStar)];case 1:return[2,(t=a.sent().UnityFeatures).isUnitySupported()?t:null];case 2:return a.sent(),[2,null];case 3:return[2]}}))}))}})),define("modules/clean/react/home/recents/actions/recent_activity_actions_post_tti",["require","exports","tslib","external/lodash","react-intl","spectrum-sharing/utils/sharing_constants","modules/clean/browse_uri_interface","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/downloads","modules/clean/filepath","modules/clean/navigation","modules/clean/react/home/constants","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/resource/actions_post_tti","modules/clean/react/home/store","modules/clean/react/modal_dig","modules/clean/sharing/async_share_modal_util","modules/core/exception","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h,v,E,y,S,T,I,b,D,C,A){"use strict";function w(e){return{index:e.index}}function M(e,t,n,a,o){var i=e.fqPath&&(s.isCloudDocByExtension(u.file_extension(e.fqPath))||l.hasPreferredEditorSupport(e.fqPath));if(e.isDir||a&&!i){var c=(function(e,t){return e.fqPath?String(r.preview_uri_for_fq_path(t,e.fqPath)):e.previewInfo&&e.previewInfo.href||null})(e,S.getHomeStore().getUser());return!!c&&(e.isDir&&!a?d.logAndNavigate(c,(function(){return h.logRecentActivityAction(f.ActionType.VIEW_FILE,t,n)}),d.NavigationMethod.REDIRECT):h.openTab(c,f.ActionType.VIEW_FILE,t,n),!0)}var m=o?f.ActionType.COMMENT:f.ActionType.VIEW_FILE;return y.openInFileViewer(e.id,(function(){return h.logRecentActivityAction(m,t,n)}),o),!0}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),c=n.__importStar(c),b=n.__importStar(b),t.shareFile=function(e,t,a){var o;return n.__awaiter(this,void 0,Promise,(function(){var r,s,l,c,u,d,m;return n.__generator(this,(function(n){switch(n.label){case 0:return r=S.getUser(),[4,v.ensureAttachments([e],f.EnsureAttachmentsPurpose.SHARE_FILE)];case 1:return s=n.sent(),l=s[0],c=l.fqPath||"",u=l.previewInfo,d=u?u.target_ns:null,m=!1,a?(y.createAutoShareLink(r,c),m=!0,[3,4]):[3,2];case 2:return[4,I.asyncShowShareModal(r,{fqPath:c,isFolder:!!(null===(o=l.previewInfo)||void 0===o?void 0:o.is_dir),origin:i.SHARE_ACTION_ORIGIN_TYPE.RECENTS,targetNsId:d})];case 3:m=n.sent(),n.label=4;case 4:return t&&m&&(h.logShareFile(r.id,c,t.totalCount,t.cellView),p.homeLogEvent(t,f.ActionType.SHARE,s,p.getFqPaths(s).indexOf(c))),[2,m]}}))}))},t.openFile=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var o,i,r,s,l,c,u;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,_.getUnityFeatures()];case 1:return o=n.sent(),b.assert(!!o,"Unity is not supported by this browser"),[4,v.ensureAttachments([e],f.EnsureAttachmentsPurpose.OPEN_FILE)];case 2:return i=n.sent(),r=i[0],s=r.nsId,l=r.nsPath,c=i[0].fqPath||"",u=S.getUserId(),o.open_file(s,l,u,a.noop,(function(e){C.Notify.error("We were unable to open this file"),b.reportException({err:Error(e),tags:["recents"],severity:b.SEVERITY.NONCRITICAL})})),t&&(h.logUnityOpenFile(u,c,t.totalCount,t.cellView),p.homeLogEvent(t,f.ActionType.OPEN,i)),[2]}}))}))},t.deleteRecentItem=function(e,t,i,r){return n.__awaiter(this,void 0,void 0,(function(){var r,s,l,c,u,d,_,f;return n.__generator(this,(function(n){return r=e.federatedRecentItem,s=e.displayType,r?b.reportStack("Deleting is not supported for federated recent items",{severity:b.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}}):(l=g.extractAttachmentIds(t),c=function(){return p.deleteAttachments(l,i)},u=void 0,d=void 0,1===l.length?(_=E.getAttachmentStore().getById(l[0]))&&_.isLoaded?(d=_.isDir?D.intl.formatMessage({id:"Z9HlH9",defaultMessage:"Delete folder?"}):D.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"}),f=s===m.DisplayTypes.SHARED_FOLDER?o.defineMessage({id:"9Fi8TL",defaultMessage:"Are you sure you want to remove the shared folder <b>{file_name}</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."}):o.defineMessage({id:"l7h1V3",defaultMessage:"Do you want to delete <b>{file_name}</b>?"}),u=D.intl.formatMessage(f,{file_name:a.escape(_.displayName||""),b:function(e){return"<b>"+e.join("")+"</b>"}})):(d=D.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"}),u=D.intl.formatMessage({id:"D3751u",defaultMessage:"Do you want to delete this file?"})):(d=D.intl.formatMessage({id:"V5KZzi",defaultMessage:"Delete files?"}),u=D.intl.formatMessage({id:"ZRCJDk",defaultMessage:"Do you want to delete <b>{num} files</b>?"},{num:a.escape(String(l.length)),b:function(e){return"<b>"+e.join("")+"</b>"}})),T.SimpleModal.show({title_text:d,body_html:u,confirm_text:D.intl.formatMessage({id:"iNfEof",defaultMessage:"Delete"}),confirm_callback:c,cancel_text:D.intl.formatMessage({id:"AqRWwC",defaultMessage:"Cancel"}),autoclose:!0})),[2]}))}))},t.downloadFiles=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var a,o;return n.__generator(this,(function(n){switch(n.label){case 0:return a=S.getUserId(),[4,v.ensureAttachments(e,f.EnsureAttachmentsPurpose.DOWNLOAD_FILES)];case 1:return o=n.sent(),t&&(h.logDownloadFile(a,p.getFqPaths(o),t.totalCount,t.cellView),p.homeLogEvent(t,f.ActionType.DOWNLOAD,o)),o.forEach((function(e){if(e.isDir&&e.fqPath&&null!=e.previewInfo&&null!=e.previewInfo.block_hash)c.get_zip({fq_paths:[e.fqPath],subject_uid:a,block_hash:e.previewInfo.block_hash,parent_path:e.fqPath});else{var t=null!=e.previewInfo&&"href"in e.previewInfo?e.previewInfo.href:void 0;t&&c.get({url:t})}})),[2]}}))}))},t.openVersions=function(e,t,a){return n.__awaiter(this,void 0,void 0,(function(){var o,i,r,s,l,c;return n.__generator(this,(function(u){switch(u.label){case 0:return o=S.getUserId(),[4,v.ensureAttachmentsWithRetryStatus([t],f.EnsureAttachmentsPurpose.OPEN_VERSIONS)];case 1:return i=u.sent(),r=i.attachments,s=i.isRetry,l=r[0].fqPath||"",c=(function(e,t,a){var o;void 0===a&&(a={});return a=n.__assign(((o={})._subject_uid=String(t),o),a),new A.URI({path:"/history"+e,query:a})})(l,o),d.logAndNavigate(c.toString(),a?function(){return h.logOpenVersions(o,l,a.totalCount,a.cellView),p.homeLogEvent(a,f.ActionType.VERSIONS,r)}:void 0,s?d.NavigationMethod.REDIRECT:e),[2]}}))}))},t.previewFileSyncRecentItem=function(e,t,a,o){return n.__awaiter(this,void 0,void 0,(function(){var i,r,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,v.ensureAttachmentsWithRetryStatus([e.attachmentIds[0]],f.EnsureAttachmentsPurpose.PREVIEW_RECENT_ITEM)];case 1:if(i=n.sent(),r=i.attachments,l=i.isRetry,1===r.length){if(c=r[0],!e.isMounted&&e.scl)return e.fqPath&&s.isPointerByExtension(e.fqPath)?h.openUnsafeTab(e.scl,f.ActionType.VIEW_FILE,e.attachmentIds,o):h.openTab(e.scl,f.ActionType.VIEW_FILE,e.attachmentIds,o),[2];if(M(c,e.attachmentIds,o,t&&!l,a.isCommentAction))return[2]}return b.reportStack("Preview failed",{severity:b.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,attachments:r,previewOptions:w(a)}}),[2]}}))}))},t.previewAttachment=function(e,t,n,a){M(t.find((function(t){return t.id===e})),g.extractAttachmentIds(t),a,d.isMetaKeyPressed(n))}})),define("modules/clean/react/home/recents/actions/recent_activity_actions_utils_post_tti",["require","exports","tslib","external/lodash","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti","modules/clean/react/home/recents/store_utils_post_tti","modules/clean/react/home/recents/utils/events","modules/clean/react/home/store","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m){"use strict";function _(e){return a.compact(a.map(e,"fqPath"))}function p(e,t,n,a){return c.logEvent(t,e.cellView,n,e.totalCount,a)}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),o=n.__importStar(o),t.getFqPaths=_,t.homeLogEvent=p,t.deleteAttachments=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var c,g,f,h,v,E;return n.__generator(this,(function(n){switch(n.label){case 0:return c=u.getUserId(),[4,l.ensureAttachments(e,i.EnsureAttachmentsPurpose.PROMPT_AND_DELETE_ATTACHMENTS)];case 1:return g=n.sent(),f=_(g),t&&(h=t.totalCount,v=t.cellView,s.logDeleteFiles(c,f,h,v),p(t,i.ActionType.DELETE,g,void 0)),E=a.uniqueId("DELETE_FILES"),r.recentActivityDispatcher.dispatch({type:i.DELETE_FILES_PENDING,attachmentIds:e,transactionId:E}),d.Snackbar.complete(m.intl.formatMessage({id:"20q1Pn",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:f.length}),"home-delete"),[4,o.deleteFiles(f.map((function(e){return{fq_path:e}})),c,!1)];case 2:return n.sent().isError?(d.Snackbar.fail(m.intl.formatMessage({id:"gq9/8S",defaultMessage:"Failed to perform the delete. Please try again later."}),"home-delete"),r.recentActivityDispatcher.dispatch({type:i.DELETE_FILES_ROLLBACK,transactionId:E})):r.recentActivityDispatcher.dispatch({type:i.DELETE_FILES_COMMIT,transactionId:E}),[2]}}))}))}})),define("modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti",["require","exports","tslib","react","dig-components/tooltips","dig-components/typography","modules/clean/react/home/util/resource_icon"],(function(e,t,n,a,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),e.stopPropagation(),t.props.handleClick(t.props.id,e)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.overlayText,n=e.file,s=e.width,l=e.height;return t?a.default.createElement("button",{onClick:this.onClick,className:"recents-item__attachment-item recents-item__attachment-item--has-overlay",style:{width:s,height:l}},a.default.createElement("span",{className:"recents-item__attachment-overlay"},a.default.createElement(i.Text,{size:"large",inverse:!0,isBold:!0},t))):a.default.createElement(o.Tooltip,{title:n.displayName,placement:"bottom"},a.default.createElement("button",{className:"recents-item__attachment-item","aria-label":n.displayName,onClick:this.onClick,style:{width:s,height:l}},a.default.createElement(r.HomeResourceIcon,{className:"recents-item__attachment-icon",displayType:n.displayType,fileName:n.displayName,isLarge:!0})))},t})((a=n.__importDefault(a)).default.Component);t.AttachmentFileIconView=s})),define("modules/clean/react/home/recents/components/attachment_grid_post_tti",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._gridWidth=e,this._gutterWidth=t}return e.create=function(t,n){return new e(t,n)},e.prototype.generate=function(e,t){void 0===t&&(t=1/0);for(var n=[],a=0;n.length<t&&a<e.length;){var o=this.buildRow(e.slice(a));a+=o.length,n.push(o)}return n},e.prototype.buildRow=function(e){for(var t=[],n=this._gridWidth+this._gutterWidth,a=0,o=e;a<o.length;a++){var i=o[a];if(!((n=n-i.width-this._gutterWidth)>=0||0===t.length))break;t.push(i)}return t},e})();t.AttachmentGrid=n})),define("modules/clean/react/home/recents/components/attachment_image_view_post_tti",["require","exports","tslib","react","classnames","dig-components/typography","dig-components/tooltips"],(function(e,t,n,a,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isLoading:!0},t.onClick=function(e){e.preventDefault(),e.stopPropagation(),t.props.handleClick(t.props.id,e)},t.onLoad=function(){t.setState({isLoading:!1})},t.onError=function(){t.props.handleLoadError(t.props.id),t.setState({isLoading:!1})},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.image,n=e.overlayText,s=a.default.createElement("button",{onClick:this.onClick,className:o.default("recents-item__attachment-item",{"recents-item__attachment-item--has-overlay":!!n}),style:{width:t.width,height:t.height},"aria-label":t.displayName},a.default.createElement("img",{alt:t.displayName,className:o.default("recents-item__attachment-thumbnail",{"recents-item__attachment-thumbnail--has-overlay":!!n,"recents-item__attachment-thumbnail--is-loading":this.state.isLoading}),src:t.thumbnailUrl,onLoad:this.onLoad,onError:this.onError}),n&&a.default.createElement("span",{className:"recents-item__attachment-overlay"},a.default.createElement(i.Text,{size:"large",inverse:!0,isBold:!0},n)));return n?s:a.default.createElement(r.Tooltip,{title:t.displayName,placement:"bottom"},s)},t})(a.default.PureComponent);t.AttachmentImageView=s})),define("modules/clean/react/home/recents/components/attachment_list_layout_post_tti",["require","exports","tslib","external/lodash","modules/clean/photos/thumbnail_url_util","modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti","modules/clean/react/home/recents/components/attachment_grid_post_tti","modules/clean/react/home/recents/components/attachment_image_view_post_tti","modules/core/browser_detection","modules/core/exception"],(function(e,t,n,a,o,i,r,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a);var u=o.ThumbnailSizeMode.FIT_ONE,d=o.ThumbnailSizeMode.EXACT_NO_BACKGROUND;var m=(function(){function e(e,t,n){this.gridWidth=e,this.columnWidth=t,this.gutterWidth=n,this._grid=r.AttachmentGrid.create(this.gridWidth,this.gutterWidth)}return e.create=function(t,n,a){return new e(t,n,a)},e.prototype.generate=function(e,t,n){var a=this.cellMetadata(e,n);return this._grid.generate(a,t)},e.prototype.cellMetadata=function(e,t){var n=this,o=a.zipObject(t,t);return e.map((function(e){var t=e.isLoaded,a=e.thumbnailUrl;return o[e.id]||t&&!a?n.buildFileIconViewMetadata(e):t?n.buildImageViewMetadata(e):n.buildLoadingImageViewMetadata(e)}))},e.prototype.buildFileIconViewMetadata=function(e){return{id:e.id,scaledThumbnailUrl:null,view:i.AttachmentFileIconView,width:this.columnWidth,height:this.columnWidth,attachment:e}},e.prototype.buildLoadingImageViewMetadata=function(e){return{id:e.id,scaledThumbnailUrl:null,view:null,width:this.columnWidth,height:this.columnWidth,attachment:e}},e.prototype.buildImageViewMetadata=function(e){var t=e.thumbnailUrl,n=this.calculateThumbnailDimensions(e.thumbnailDimensions),a=n.width,i=n.height,r=n.variant;return t.startsWith("data:")||(t=(function(e,t){var n,a,i,r=l.is_high_density_display();switch(t){case"aggregated-scaled":i=r?200:100,n=r?200:100,a=u;break;case"aggregated-cropped":i=r?200:100,n=r?200:100,a=d;break;case"aggregated-wide-cropped":i=r?718:359,n=r?200:100,a=d;break;default:return c.assert(!1,"invalid ThumbnailVariant: "+t),""}return o.thumbnailUrlForSize(e,i,n,a)})(t,r)),{id:e.id,view:s.AttachmentImageView,scaledThumbnailUrl:t,width:a+0,height:i+0,attachment:e}},e.prototype.calculateThumbnailDimensions=function(e){var t,n,a;if(e){a="aggregated-scaled";var o=e.width/e.height;t=this.columnWidth,(n=Math.floor(o*t))>this.columnWidth-0&&(a="aggregated-wide-cropped",n=this.columnWidth-0)}return(!e||n<75)&&(a="aggregated-cropped",n=this.columnWidth,t=this.columnWidth),{width:n,height:t,variant:a}},e})();t.AttachmentListLayout=m})),define("modules/clean/react/home/recents/components/attachment_list_view_post_tti",["require","exports","tslib","external/lodash","react","modules/clean/components/loading_indicator","modules/clean/react/home/constants","modules/clean/react/home/recents/actions/recent_activity_actions_post_tti","modules/clean/react/home/recents/components/attachment_file_icon_view_post_tti","modules/clean/react/home/recents/components/attachment_image_view_post_tti","modules/clean/react/home/recents/components/attachment_list_layout_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/store_utils_post_tti","modules/core/i18n"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a);var p=(function(e){function t(t){var a=e.call(this,t)||this;return a.previewAttachment=function(e,t){var n=a.props.attachments,o={totalCount:n.length,cellView:a};s.previewAttachment(e,n,t,o)},a.handleImageLoadError=function(e){var t=n.__spreadArrays(a.state.errored);t.push(e),a.setState({errored:t})},a.revealNextGroup=function(){a.setState({rows:a.state.rows+d.SHOW_MORE_THUMBNAIL_ROW_INCREMENT})},a.state={rows:1,errored:[],expandedAttachments:{},grid:[]},a}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.updateLayoutController()},t.prototype.componentDidUpdate=function(e,t){e.width===this.props.width&&t.errored===this.state.errored&&t.rows===this.state.rows||(this.updateLayoutController(),this.state.rows>t.rows&&this.loadRemainingAttachments())},t.prototype.updateLayoutController=function(){this.props.width&&this.props.width>0&&this.setState({grid:a.flattenDeep(u.AttachmentListLayout.create(this.props.width,this.props.width>400?100:50,8).generate(this.props.attachments,this.isLoading()?1:this.state.rows,this.state.errored))})},t.prototype.loadRemainingAttachments=function(){var e=this.props.attachments.filter((function(e){return!e.isLoaded})).map((function(e){return e.id}));e.length&&m.ensureAttachments(e,d.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS)},t.prototype.isLoading=function(){return this.state.rows>1&&this.props.attachments.some((function(e){return!e.isLoaded}))},t.prototype.renderAttachmentItems=function(){var e=this,t=this.props.attachments,n=this.state.grid;if(!n.length)return[];var a=this.previewAttachment,i=n.length,s=t.length,u=s-i+1,d=!this.isLoading()&&i<s;return n.map((function(t,i){var s;d&&i===n.length-1&&(a=e.revealNextGroup,s=_.intl.formatMessage({id:"o+CHKf",defaultMessage:"+{count}"},{count:u}));var m=t.attachment,p=t.view,g=t.id,f=t.scaledThumbnailUrl,h=t.width,v=t.height,E=m.displayName,y=m.displayType;switch(p){case l.AttachmentFileIconView:return o.default.createElement(l.AttachmentFileIconView,{key:"attachment-"+g,id:g,file:{displayName:E||"",displayType:y||r.DisplayTypes.FILE},overlayText:s,handleClick:a,width:h,height:v});case c.AttachmentImageView:return o.default.createElement(c.AttachmentImageView,{key:"attachment-expanded-"+g,overlayText:s,id:g,image:{thumbnailUrl:f,displayName:E||"",width:h,height:v},handleClick:a,handleLoadError:e.handleImageLoadError});default:return null}}))},t.prototype.renderLoadingView=function(){return o.default.createElement("div",{className:"attachment-loading"},o.default.createElement(i.LoadingIndicator,{style:i.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER,className:"recents-loading-indicator"}))},t.prototype.render=function(){var e=null;return this.isLoading()&&(e=this.renderLoadingView()),o.default.createElement(o.default.Fragment,null,this.renderAttachmentItems(),e)},t})((o=n.__importDefault(o)).default.Component);t.AttachmentListView=p})),define("modules/clean/react/home/recents/components/recent_activity_container_post_tti",["require","exports","tslib","external/lodash","modules/clean/sharing/share_modal_util","modules/clean/sharing/wizard/wizard_modals"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.generateModalSessionId=o.generateModalSessionId,t.shareExistingFolder=i.shareExistingFolder,t.recentActivityContainerComponentDidMount=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){return(function(e){var t=0,n=function(){var n=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,a=document.documentElement.scrollHeight-window.innerHeight;n/a>.8&&a>t&&(e(),t=a)};window.addEventListener("scroll",a.throttle(n,150)),n()})(e),[2]}))}))}})),define("modules/clean/react/home/recents/recent_activity_client_post_tti",["require","exports","tslib","modules/constants/python","external/lodash","modules/clean/react/home/api","modules/clean/react/home/recents/recent_activity_client_utils"],(function(e,t,n,a,o,i,r){"use strict";function s(e,t,n,a){return void 0===a&&(a=!0),i.makeRequest({subject_user:e,type:"POST",url:t,data:n},{isBackground:a})}function l(e,t,a,o){return void 0===o&&(o=!0),n.__awaiter(this,void 0,void 0,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return i=r.getPayload,[4,s(e,t,a,o)];case 1:return[2,i.apply(void 0,[n.sent()])]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),t.fetchPayload=l,t.recentsJson=function(e,t){return s(e,"/recents/json",{num_activities:t?20:10,cursor:t})},t.retrievePaperRecents=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,s(e,"/home_feed/retrieve_paper_recents",{is_initial_fetch:t})];case 1:return[2,n.sent()]}}))}))},t.postLogEvent=function(e,t){i.makeRequest({url:"/recents/logger",type:"POST",subject_user:e,data:t,dataType:"text"},{isBackground:!0})},t.archivePaperResources=function(e,t){return l(e,"/home_feed/archive_paper_resources",{resources_json:JSON.stringify(t)},!1)},t.activityGenerateJson=function(e,t,i){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l(e,"/activity/generate/json",{activity_keys:JSON.stringify(o.uniq(t)),loading_modes:JSON.stringify([a.FILE_ACTIVITY_LOADING_MODE.PREVIEW_INFO]),encrypted:i})];case 1:return[2,n.sent().activities_by_activity_key]}}))}))},t.checkFileInRootCollection=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l(e,"/recents/check_files_in_root_collection",{files_json:JSON.stringify(t)})];case 1:return[2,n.sent().file_in_root_collection_info]}}))}))}})),define("modules/clean/react/home/recents/recent_activity_file_action_post_tti",["require","exports","tslib","react","modules/clean/filepath","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/data/types","modules/clean/react/home/resource_id_types","modules/clean/react/home/store","modules/clean/react/home/util/file_utils"],(function(e,t,n,a,o,i,r,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var n=e.call(this,t)||this;return n.onActionDropdownOpen=function(){n.setState({isActionDropdownOpen:!0})},n.onActionDropdownClose=function(){n.setState({isActionDropdownOpen:!1})},n.state={isActionDropdownOpen:!1},n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.recentItem,n=e.attachments;if(!(t&&t.idType===s.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&n.length&&t.viewingUserId&&t.displayName))return null;var u=c.getFileFromPartial({file_id:t.resourceId,ext:"."+o.file_extension(t.displayName),ns_id:n[0].nsId||void 0,ns_path:n[0].nsPath||void 0,fq_path:n[0].fqPath||void 0});return a.default.createElement(i.UnconnectedExtensionsMenu,{className:"recents-item__action recents-item__action--hover-only recents-item__action--standard-breakpoint-only",user:l.getUser(),file:u,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_recent"},triggerType:r.TriggerType.OpacityButton})},t})((a=n.__importDefault(a)).default.PureComponent);t.RecentActivityFileActionPost=u})),define("modules/clean/react/home/recents/recent_activity_logger_post_tti",["require","exports","tslib","external/lodash","modules/core/exception","modules/clean/react/home/recents/recent_activity_client_post_tti"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a);t.FilterViews={EVERYTHING:"everything"};var r=["is_full_page","item_count","contains_aggregation","latency","is_paginated"],s=["failure_type","is_paginated"],l=["in_aggregation","filter_view","action_type","target_activity_type","action_scope","position","file_extension","days_ago"],c=["latency","action_type","action_scope"],u=!0;function d(e,t,a){if(void 0===a&&(a={}),u){var o=n.__assign(n.__assign({},a),{event_name:t});i.postLogEvent(e,o)}}function m(e,t,n){var i=Object.keys(n),r=a.difference(i,t);o.assert(0===r.length,e+" called with unsupported keys: "+r)}t.enableLogging=function(){u=!0},t.disableLogging=function(){u=!1},t.logPageLoaded=function(e,t){m("logPageLoaded",r,t),d(e,"client_page_loaded",t)},t.logRequestFailed=function(e,t){m("logRequestFailed",s,t),d(e,"request_failed",t)},t.logCellAction=function(e,t){m("logCellAction",l,t),d(e,"cell_action",t)},t.logTimeToFirstAction=function(e,t){m("logTimeToFirstAction",c,t),d(e,"time_to_first_action",t)}})),define("modules/clean/react/home/recents/recent_activity_logger_utils_post_tti",["require","exports","tslib","react-dom","external/lodash","modules/clean/react/home/recents/utils/events","modules/clean/react/home/recents/recent_activity_logger_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/stores/attachment_store","modules/clean/web_timing_logger","modules/clean/navigation","modules/clean/react/home/recents/recent_activity_logger_utils"],(function(e,t,n,a,o,i,r,s,l,c,u,d){"use strict";function m(e,t,i,l,u){var m=a.findDOMNode(u);if(null!==m){var _,p=o.filter(o.uniq(o.map(i,(function(e){return null!=e?e.split(".").pop().toLowerCase():void 0}))),Boolean),g=l>1;_=1===l?s.ActionScope.SINGLE:i.length===l?s.ActionScope.AGGREGATION:s.ActionScope.SUBSET;var f,h=Array.prototype.indexOf.call(m.parentNode.childNodes,m),v=Number(m.getAttribute("data-item-type")),E=Number(m.getAttribute("data-item-date")),y={in_aggregation:g,filter_view:r.FilterViews.EVERYTHING,action_type:e,action_scope:_,target_activity_type:v,position:h,file_extension:p.join(","),days_ago:(f=E,Math.floor((Date.now()-f)/864e5))};r.logCellAction(t,y),(function(e,t){if(!d.canLogFirstAction())return;var a=c.start_time();if(!a)return;d.onLogFirstAction(),r.logTimeToFirstAction(e,n.__assign(n.__assign({},t),{latency:Date.now()-a}))})(t,o.pick(y,"action_scope","action_type"))}}function _(e){return function(t,n,a,o){m(e,t,n,a,o)}}function p(e){return function(t,n,a,o){return _(e)(t,[n],a,o)}}function g(e,t,a){void 0===a&&(a={});var o=n.__assign(n.__assign({is_full_page:t.isFullPage},a),{latency:Date.now()-t.startTime});r.logPageLoaded(e,o)}function f(e,t,n){var a=l.getAttachmentStore().getByIds(t);return i.logEvent(e,n.cellView,a,n.totalCount)}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),o=n.__importStar(o),c=n.__importStar(c),t.logShareFile=p(s.ActionType.SHARE),t.logPreviewFiles=_(s.ActionType.VIEW_FILE),t.logDeleteFiles=_(s.ActionType.DELETE),t.logUnityOpenFile=p(s.ActionType.UNITY_OPEN),t.logOpenPathUrl=_(s.ActionType.OPEN_DIR),t.logOpenSharedLinkUrl=_(s.ActionType.VIEW_SHARED_LINK),t.logCommentFile=p(s.ActionType.COMMENT),t.logDownloadFile=_(s.ActionType.DOWNLOAD),t.logOpenVersions=p(s.ActionType.VERSIONS),t.logViewInFolder=_(s.ActionType.VIEW_IN_FOLDER),t.logRequestFailed=function(e,t){r.logRequestFailed(e,{failure_type:t?t.status:-1,is_paginated:!1})},t.startRequestTimer=function(){var e=d.getRecentsLoggingData();return function(t,n){return void 0===n&&(n={}),g(t,e,n)}},t.logRecentsLoaded=g,t.logRecentActivityAction=f,t.openTab=function(e,t,n,a){u.logAndNavigate(e,(function(){return f(t,n,a)}),u.NavigationMethod.NEW_TAB)},t.openUnsafeTab=function(e,t,n,a){u.logAndNavigate(e,(function(){return f(t,n,a)}),u.NavigationMethod.UNSAFE_NEW_TAB)},t.openUrl=function(e,t,n,a){u.logAndNavigate(e,(function(){return f(t,n,a)}),u.NavigationMethod.REDIRECT)}})),define("modules/clean/react/home/recents/recent_activity_starred_post_tti",["require","exports","modules/clean/react/starred/constants","modules/clean/react/starred/actions","modules/clean/react/home/recents/recent_activity_federated_model","modules/clean/react/home/store","modules/clean/react/home/recents/recent_activity_starred","modules/clean/flux/dispatcher"],(function(e,t,n,a,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setStarredStatusOfPaperRecentItems=function(e){e.length&&s.Dispatcher.dispatch({type:n.StarredActionTypes.SET_STATUS,starredStatuses:e.map((function(e){return new o.FederatedRecentItem(e).getStarredStatus()}))})},t.fetchStarredStatus=function(e){var t=r.getIdTypePairsByRecentActivityItems(e);t.length&&a.StarredActions.fetchStatuses(i.getRole(),t,!0)}})),define("modules/clean/react/home/recents/store_utils_post_tti",["require","exports","tslib","external/lodash","modules/core/i18n","modules/clean/react/home/recents/stores/attachment_store","modules/core/notify","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_client_post_tti","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/post_tti/unity_post_tti","modules/clean/react/home/recents/store_utils","modules/clean/react/home/recents/recent_activity_logger_utils_post_tti"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p){"use strict";function g(e){return n.__awaiter(this,void 0,void 0,(function(){var t,o,r,d,_,p=this;return n.__generator(this,(function(g){switch(g.label){case 0:return s.recentActivityDispatcher.dispatch({type:c.ADD_PENDING_ACTIVITY_KEYS,activityKeys:e}),t=i.getAttachmentStore().groupIdsByEncryptedToken(e),o=u.getUserId(),r={},d=0,[4,Promise.all(a.map(t,(function(e,t){return n.__awaiter(p,void 0,void 0,(function(){var a;return n.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),a=[n.__assign({},r)],[4,l.activityGenerateJson(o,e,t)];case 1:return r=n.__assign.apply(void 0,a.concat([i.sent()])),[3,3];case 2:return i.sent(),s.recentActivityDispatcher.dispatch({type:c.REMOVE_PENDING_ACTIVITY_KEYS,activityKeys:e}),d++,[3,3];case 3:return[2]}}))}))})))];case 1:if(g.sent(),s.recentActivityDispatcher.dispatch({type:c.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY,rawRelatedActivitiesByKey:r,userId:o}),(_=a.map(r,(function(e){return{ns_id:e.ns_id,ns_path:e.ns_path}}))).length&&(m.getUnityFeatures().then((function(e){e&&e.check_file_batch(_,o,null).then((function(e){s.recentActivityDispatcher.dispatch({type:c.RECEIVE_CAN_OPEN_INFO,canOpenInfo:e})}))})),l.checkFileInRootCollection(o,_).then((function(e){return s.recentActivityDispatcher.dispatch({type:c.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO,fileInRootCollectionInfo:e})}))),d)throw new Error(d+" activityGenerateJson failures");return[2]}}))}))}function f(e,t,a){return void 0===a&&(a=c.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS),n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,v(e,t,a)];case 1:return[2,n.sent().attachments]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.ensureAttachments=f;var h=[c.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS,c.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION];function v(e,t,a,s){return void 0===a&&(a=c.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS),void 0===s&&(s=!1),n.__awaiter(this,void 0,Promise,(function(){var l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return l=i.getAttachmentStore().getByIds(e),(c=l.filter((function(e){return!e.isLoaded})).map((function(e){return e.id}))).length?i.getAttachmentStore().areSomeActivityKeysPending(c)?[4,new Promise((function(n,o){var r=i.getAttachmentStore().addListener((function(){i.getAttachmentStore().areSomeActivityKeysPending(c)||(r(),v(e,t,a,!0).then(n,o))}))}))]:[3,2]:[3,10];case 1:return[2,n.sent()];case 2:if(!(a>0))return[3,8];n.label=3;case 3:return n.trys.push([3,5,,6]),[4,g(c)];case 4:return n.sent(),[3,6];case 5:return n.sent(),[3,6];case 6:return[4,v(e,t,a-1,!0)];case 7:return[2,n.sent()];case 8:throw d.reportStack("retry attempts depleted",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{attachmentIds:e,purpose:t}}),h.indexOf(t)<0&&r.Notify.error(o.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),new Error("retry attempts depleted");case 9:return[3,11];case 10:return[2,{attachments:l,isRetry:s}];case 11:return[2]}}))}))}function E(){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(e){return[2,{logRecentsLoaded:p.logRecentsLoaded,ensureAttachments:f,logRequestFailed:p.logRequestFailed,loadPaperRecentItems:y}]}))}))}function y(e){return n.__awaiter(this,void 0,void 0,(function(){var t,a,o;return n.__generator(this,(function(n){switch(n.label){case 0:return t=l.retrievePaperRecents(u.getUserId(),e),a=_.handleRetrievePaperRecentsPromise,o=[E],[4,t];case 1:return a.apply(void 0,o.concat([n.sent(),e])),[2]}}))}))}t.ensureAttachmentsWithRetryStatus=v,t.loadPaperRecentItems=y,t.loadRecentItems=function(e){var t=this;return _.logErrorAndRethrowAsync(E,(function(){return n.__awaiter(t,void 0,void 0,(function(){var t,a;return n.__generator(this,(function(n){switch(n.label){case 0:return t=_.handleAndLogRecentsJsonPromise,a=[E],[4,l.recentsJson(u.getUserId(),e)];case 1:return[2,t.apply(void 0,a.concat([n.sent(),!e]))]}}))}))}))}})),define("modules/clean/react/home/resource/actions_post_tti",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/home/store","modules/clean/react/home/resource/store","modules/clean/referrer_cleansing_redirect","modules/constants/python","modules/clean/react/file_viewer/controller","modules/core/browser","modules/clean/filepath","modules/clean/react/home/api","modules/clean/react/home/post_tti/props_post_tti","modules/core/uri","modules/clean/previews/data/preview_type_util","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","modules/core/browser","modules/clean/cloud_docs/event_logging","spectrum/util/uuid_generator","modules/clean/react/plusplus/logging","modules/clean/pnm/utils","modules/clean/react/plusplus/file_actions"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h,v,E,y,S,T,I,b,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=n.__importStar(s),y=n.__importStar(y),t.createAutoShareLink=function(e,t){var n=new p.URI({path:"/sm/create"+d.normalize(t)});n.updateQuery("_subject_uid",e.id.toString()),n.updateQuery("redirect","0"),m.makeRequest({url:n.toString(),type:"POST",data:null,dataType:"text"}).then((function(e){return u.redirect(e)}))},t.openInFileViewer=function(e,t,n){var u=r.getHomeResourceStore().addListener((function(){var e=r.getHomeResourceStore().getFileToPreview();if(e){var d=(function(e){if(g.isCloudDoc(e.preview))return e.preview.content.exit_url})(e),m=i.getHomeStore().getUser();if(d)if(t(),u(),h.POINTER_EXTS.includes(v.getFileExt(e).slice(1)))s.safe_open_tab_and_redirect(d),S.logUserAction({actionEvent:E.UserActionEventType.PRE_OPEN,userId:m.id,docPathOrId:e.file_id,actionSource:E.UserActionSourceType.WEB_HOME});else{var C=T.generateUUID("web_open_id"),A=p.URI.parse(d).updateQuery("web_open_id",C).toString();y.open_tab(A),S.logUserAction({actionEvent:E.UserActionEventType.PRE_OPEN,userId:m.id,docPathOrId:e.file_id,actionSource:E.UserActionSourceType.WEB_HOME,data:{webOpenId:C}})}else{var w=function(){return(function(e,t,n,i){window.requestAnimationFrame((function(){if(c.isShown())c.updateFiles([e]);else{var r="/recents"===location.pathname?l.FileViewOriginType.RECENTS:l.FileViewOriginType.HOME;c.open([e],0,t,"react-file-viewer",{canClose:!0,oref:l.OREF_CONSTANTS.HOME,fileViewTarget:l.FileViewTargetType.PRIVATE,fileViewOrigin:r,fileViewAction:l.FileViewActionType.CLICK,onClose:function(){return a.Dispatcher.dispatch({type:o.HomeActionTypes.CLOSE_FILE_VIEWER})}}),a.Dispatcher.dispatch({type:o.HomeActionTypes.OPEN_FILE_VIEWER})}n(),i()}))})(e,m,t,u)};e.hasOwnProperty("per_node_metadata")&&b.isSupportedLinkNodeClickAction(e.per_node_metadata)?D.handleLinkNodeAction(e.per_node_metadata,(function(e){I.logProductAnalytics(m.id,"web","select",e,"home")})):!n&&f.hasPreferredEditorSupport(e)?_.getPostTTIProps().then((function(n){var a=n.preferredEditors;f.openInPreferredEditor(m,e,a,w,{fileViewAction:l.FileViewActionType.CLICK,fileViewOrigin:l.FileViewOriginType.HOME}),t(),u()})):w()}}}));a.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.REQUEST_PREVIEW,resourceId:e})}})),define("modules/clean/react/home/resource/api_post_tti",["require","exports","modules/clean/react/home/api"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileMetadata=function(e,t){return n.makeRequest({url:"/home_feed/get_file_metadata",type:"POST",subject_user:e.id,data:{resources_json:JSON.stringify(t)}},{isBackground:!0})}})),define("modules/clean/react/home/roots/home_access_web_post_tti",["require","exports","tslib","modules/clean/history","modules/clean/upsell/prompt_event_emitter"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.homeAccessWebComponentDidMount=function(t,i){return n.__awaiter(this,void 0,void 0,(function(){var r=this;return n.__generator(this,(function(s){return a.default.remove_query_param("role"),t&&new Promise((function(t,n){e(["modules/clean/payments/snapengage"],t,n)})).then(n.__importStar).then((function(e){return e.DEPRECATED_ajaxFetchAndLoadSnapengageParams()})),o.promptBufferedEventEmitter.on(o.Events.ON_PROMPT_INITIALIZED,(function(t){return n.__awaiter(r,void 0,void 0,(function(){return n.__generator(this,(function(a){switch(a.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:i?[4,new Promise((function(t,n){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,n)})).then(n.__importStar)]:[3,2];case 1:(0,a.sent().postTTINCCTReminderModal)(),a.label=2;case 2:return[2]}}))}))})),[2]}))}))}})),define("modules/clean/react/home/starred/actions_post_tti",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/resource/api_post_tti","modules/clean/react/starred/id_type_pair","modules/clean/react/home/constants","modules/clean/react/home/store","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/api_post_tti","modules/clean/react/home/starred/actions"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";function d(e){return n.__awaiter(this,void 0,void 0,(function(){var t,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return 0===(t=e.map((function(e){return e.idTypePair}))).length?[2]:[4,o.getFileMetadata(s.getUser(),t)];case 1:return l=n.sent(),c={},l.forEach((function(e){return c[i.idTypePairToString(e)]=e.file_metadata})),a.Dispatcher.dispatch({type:r.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:c}),[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.loadAllStarredItems=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(n){switch(n.label){case 0:a.Dispatcher.dispatch({type:l.StarredResourceActionTypes.LOADING_ALL}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c.retrieveStarred(l.LOAD_ALL_ITEMS_COUNT)];case 2:return e=n.sent(),[3,4];case 3:throw t=n.sent(),u.onRetrieveStarredError(l.StarredLoadingTypes.ALL,t);case 4:return u.StarredActions.handleRetrieveStarredPayload((function(){return Promise.resolve({getStarredStatusMetadata:d})}),l.StarredLoadingTypes.ALL,e),[2]}}))}))},t.getStarredStatusMetadata=d})),define("modules/clean/react/home/starred/api_post_tti",["require","exports","tslib","modules/clean/react/home/api","modules/clean/react/home/store"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveStarred=function(e){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,a.makeRequest({url:"/home_feed/retrieve_starred",type:"POST",data:{role:o.getRole(),limit:e}})];case 1:return[2,t.sent()]}}))}))}})),define("modules/clean/react/home/starred/starred_item_file_action_post_tti",["require","exports","tslib","react","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/data/types","modules/clean/react/home/recents/models/utils","modules/clean/react/home/resource_id_types","modules/clean/react/home/util/file_utils"],(function(e,t,n,a,o,i,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.onActionDropdownOpen=function(){n.setState({isActionDropdownOpen:!0})},n.onActionDropdownClose=function(){n.setState({isActionDropdownOpen:!1})},n.state={isActionDropdownOpen:!1},n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.starredItem,n=e.user;if(t.idType!==s.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID||!n.id||!t.title)return null;var c=l.getFileFromPartial({file_id:t.resourceId,fq_path:t.details.fqPath||void 0,ext:r.getExtension(t.title)});return a.default.createElement(o.UnconnectedExtensionsMenu,{className:"starred-item__file-actions",file:c,user:this.props.user,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_starred"},triggerType:i.TriggerType.OpacityButton})},t})((a=n.__importDefault(a)).default.PureComponent);t.StarredItemFileActionPost=c})),define("modules/clean/react/home/util/feedback_button",["require","exports","tslib","react","spectrum/icon_form","modules/clean/react/home/constants","modules/clean/react/home/content_suggestions/actions_post_tti","modules/clean/react/home/content_suggestions/models/suggested_item","modules/clean/react/home/content_suggestions/util/logging/home_suggest_logger","modules/clean/react/home/store","modules/core/i18n","modules/core/notify"],(function(e,t,n,a,o,i,r,s,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissItemClick=function(e){e.stopPropagation(),e.preventDefault();var n=t.props,a=n.feature,o=n.position,m=n.suggested;l.homeSuggestLogger.logClickDismissSuggestedItem(m,l.withHomePrefix(i.HomeSections.SUGGEST),"dismiss-suggested-item",o);var _=m,p=c.getHomeStore().getUser(),g=s.suggestedItemToIdTypePair(_),f=_.filename;l.homeSuggestLogger.logDismissSuggestedItem(_,l.withHomePrefix(i.HomeSections.SUGGEST),"dismiss-suggested-item",o,"no_feedback_modal"),r.dismissSuggestedItem(p,g,a).catch((function(e){var t;t=f?u.intl.formatMessage({id:"YmEqih",defaultMessage:"There was a problem dismissing {item_name}"},{item_name:f}):u.intl.formatMessage({id:"rBSlLP",defaultMessage:"There was a problem dismissing your selection"}),d.Notify.error(t)}))},t}return n.__extends(t,e),t.prototype.render=function(){return a.default.createElement("button",{className:"tile__action-dismiss",onClick:this.onDismissItemClick,"aria-label":u.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"})},a.default.createElement(o.IconForm,{className:"tile__action-icon",name:"cancel"}))},t})((a=n.__importDefault(a)).default.PureComponent);t.FeedbackButton=m})),define("modules/clean/react/home/util/file_utils",["require","exports","tslib","modules/clean/react/browse/models"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={bytes:1024,direct_blockserver_link:"",event_type:0,ext:"",file_id:"",fq_path:"",href:"",icon:"",is_cloud_doc:!1,is_dir:!1,is_in_team_folder_tree:!1,is_in_vault_folder:!1,is_symlink:!1,is_locked:!1,is_unmounted:!1,is_versionable:!0,_mount_access_perms:[],ns_id:0,ns_path:"",revision_id:"",sjid:0,sort_key:[""],target_ns:null,type:1};t.getFileFromPartial=function(e){return e&&Object.keys(e).forEach((function(t){void 0===e[t]&&delete e[t]})),new a.File(e?n.__assign(n.__assign({},o),e):o)}})),define("modules/clean/react/home/util/logging/availability_logger_post_tti",["require","exports","tslib","external/lodash","modules/clean/react/home/constants","modules/clean/react/home/api","modules/clean/react/home/store","modules/clean/react/home/util/logging/availability_logger_common"],(function(e,t,n,a,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.logHomeAvailability=function(e){var t=e.sectionToTTI,l=e.sectionToIsSkipped,c=e.sectionToTTData,u=e.typeToExecutionData,d={};Object.keys(o.HomeSections).forEach((function(e){var n=o.HomeSections[e];d[n]={tti:t[n],tt_data:c[n],skipped:l[n]}}));var m=r.getHomeStore(),_=m.getUser();i.makeRequest({url:"/log/home_availability",type:"POST",dataType:"text",subject_user:_.id,data:{success:a.values(u).every((function(e){return e.success||!s.isPendingPrefetch(m,e)})),metrics_json:JSON.stringify({referrer:document.referrer}),sections_json:JSON.stringify(d),prefetches_json:JSON.stringify(a.mapValues(u,(function(e,t){var a=e.success,o=e.homeTiming,i=s.HOME_PREFETCH_TYPE_TO_INFO[t].section;return n.__assign(n.__assign({},o),{conditional_loading_preference:m.getSectionLoadingPreference(i),conditional_loading_mode:m.getSectionLoadingMode(i),success:!!a})})))}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0})}})),define("modules/clean/react/prompt/version",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTopNotificationContent=function(e){var t=e;return void 0!==t.buttonText&&void 0!==t.buttonUrl},t.isTargetedBubbleContent=function(e){return void 0!==e.targetSelector},t.isConfirmableContent=function(e){return void 0!==e.confirmUrl}})),define("modules/clean/react/radio",["require","exports","tslib","classnames","react","react-dom"],(function(e,t,n,a,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),i=n.__importStar(i),t.RadioItemVariant={Normal:"normal",Large:"large"};var r=Object.keys(t.RadioItemVariant).map((function(e){return t.RadioItemVariant[e]})),s=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(){t._isSelected()||(i.findDOMNode(t.refs.input).focus(),"function"==typeof t.props._radioGroupData.onSelect&&t.props._radioGroupData.onSelect(t.props.value))},t._handleChange=function(){"function"==typeof t.props._radioGroupData.onSelect&&t.props._radioGroupData.onSelect(t.props.value)},t._getId=function(){return t.props._radioGroupData.name+"_"+t.props.value},t._isSelected=function(){return t.props._radioGroupData.radioGroupValue===t.props.value},t}return n.__extends(s,e),s.prototype.render=function(){var e=this.props._radioGroupData,n=["c-radio-wrapper",this.props.className],i={"c-radio":!0,"c-radio--selected":this._isSelected()};return Array.from(r).includes(e.variant)&&e.variant!==t.RadioItemVariant.Normal&&(i["c-radio--"+e.variant]=!0),o.default.createElement("div",{className:a.default(n),onClick:this._handleClick},o.default.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:e.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),o.default.createElement("div",{className:a.default(i)},o.default.createElement("div",{className:"c-radio__inner"})),o.default.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))},s.displayName="RadioItem",s})(o.default.Component);t.RadioItem=s;var l=(function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRadioItemSelect=function(e){null!=t.props.valueLink&&t.props.valueLink.requestChange(e)},t}return n.__extends(i,e),i.prototype.render=function(){var e=this,t=this.props.name||"radio-"+Math.floor(1e9*Math.random()),n=o.default.Children.map(this.props.children,(function(n){return"RadioItem"===n.type.displayName?o.default.cloneElement(n,{_radioGroupData:{variant:e.props.variant,name:t,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):n})),i={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},r=["c-radio-group","align-"+this.props.align,this.props.className];return o.default.createElement("fieldset",{className:a.default(r)},o.default.createElement("legend",{className:a.default(i)},this.props.legend),n)},i.displayName="RadioGroup",i.defaultProps={className:"null",type:t.RadioItemVariant.Normal,align:"middle",displayLegend:!1},i})(o.default.Component);t.RadioGroup=l})),define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["require","exports","tslib","react","react-dom-factories","modules/clean/react/css","modules/clean/viewer","modules/core/i18n","spectrum/modal","spectrum/radio_button","spectrum/label"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={option:"new-folder",open:!0},t.onSubmit=function(){return t.props.onSubmit(t.state.option)},t.onModalReady=function(){t.focusOnRadioButton()},t.closeModal=function(){t.setState({open:!1})},t.getTitle=function(e){switch(e){case"work":return s.intl.formatMessage({id:"6wTYJs",defaultMessage:"Share a folder from your {team_name} Dropbox"},{team_name:r.Viewer.get_viewer().team_name});case"personal":return s.intl.formatMessage({id:"aFGv5u",defaultMessage:"Share a folder from your personal Dropbox"})}},t.renderSpectrumContent=function(){return a.default.createElement("form",{className:"shared-folder-wizard__contents"},t._renderHeader(),t.renderSpectrumRadio())},t._renderHeader=function(){return o.default.div({className:"shared-folder-wizard__header u-mar-bottom-s"},s.intl.formatMessage({id:"e1JgO7",defaultMessage:"What would you like to do?"}))},t.renderSpectrumRadio=function(){return a.default.createElement("div",{className:"shared-folder-wizard__radio-group"},t.renderRadioOptionWithLabel("new-folder",s.intl.formatMessage({id:"UA9nt1",defaultMessage:"I’d like to create and share a new folder"})),t.renderRadioOptionWithLabel("existing-folder",s.intl.formatMessage({id:"6MC56E",defaultMessage:"I’d like to share an existing folder"})))},t.renderRadioOptionWithLabel=function(e,n){return a.default.createElement("div",{className:"shared-folder-wizard__audience-input u-mar-bottom-xs"},a.default.createElement(u.Label,{htmlFor:e,key:e+"-label"},a.default.createElement(c.RadioButton,{"aria-checked":t.state.option===e,checked:t.state.option===e,onChange:t.updateOption(e),value:e,id:e}),a.default.createElement("div",{className:e+"_title u-l-ib u-pad-left-xs"},n)))},t.updateOption=function(e){return function(){return t._handleChange(e)}},t._handleChange=function(e){return t.setState({option:e})},t._renderButtons=function(){return o.default.div({className:"u-mar-top-m clearfix"},o.default.div({className:"u-l-fr"},o.default.button({className:"c-btn c-btn--primary",onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.option)}},s.intl.formatMessage({id:"vJgZg+",defaultMessage:"Next"}))))},t}return n.__extends(t,e),t.prototype.render=function(){return a.default.createElement(l.UtilityModal,{open:this.state.open,primaryAction:s.intl.formatMessage({id:"vJgZg+",defaultMessage:"Next"}),onPrimaryAction:this.onSubmit,displayCloseButton:!0,overlayClassName:"shared-folder-wizard__overlay",overlayClickClose:!0,onRequestClose:this.closeModal,ariaLabel:s.intl.formatMessage({id:"Uj/CzJ",defaultMessage:"New Shared Folder Modal"}),className:"shared-folder-wizard",title:this.getTitle(this.props.user.role),onReady:this.onModalReady},this.renderSpectrumContent())},t.prototype.focusOnRadioButton=function(){var e=document.querySelector("input#new-folder.mc-radio");e&&e.focus()},t.displayName="ShareAFolderWizardModalNoCss",t})(a.default.Component);t.ShareAFolderWizardModal=i.requireCssWithComponent(d,["/static/css/sharing/wizard_modals-vflx-yihK.css","/static/css/modal-vflp8UKYY.css"])})),define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["require","exports","tslib","react","react-dom-factories","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/viewer","modules/core/i18n","spectrum/modal","spectrum/button"],(function(e,t,n,a,o,i,r,s,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o);var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!0},t.getTitle=function(e){switch(e){case"work":return c.intl.formatMessage({id:"cnxV88",defaultMessage:"Choose a folder from your {team_name} Dropbox"},{team_name:l.Viewer.get_viewer().team_name});case"personal":return c.intl.formatMessage({id:"1EXUnv",defaultMessage:"Choose a folder from your personal Dropbox"})}},t.onModalCloseClick=function(){t.setState({open:!1})},t._renderContent=function(){return o.default.form({className:"existing-shared-folder-wizard__contents",onSubmit:function(){return t.props.onSubmit(t.state.folderPath,t._setError)}},t._renderError(),t._renderTreeView(),t._renderButtons())},t.renderSpectrumContent=function(){return a.default.createElement("form",{className:"existing-shared-folder-wizard__contents"},t._renderError(),t._renderTreeView())},t._renderError=function(){if(null!=t.state.folderPath&&(null!=t.state.errorMsg?t.state.errorMsg.length:void 0)>0)return o.default.div({className:"text-input-error-wrapper"},o.default.div({className:"text-input-error-text u-font-danger"},t.state.errorMsg))},t._renderTreeView=function(){return a.default.createElement(s.UserFolderTreeView,{user:t.props.user,is_paired:!1,onFolderSelected:t._setFolderPath,treeRootName:l.Viewer.get_role_title(t.props.user)||c.intl.formatMessage({id:"rIir19",defaultMessage:"Dropbox"})})},t._renderButtons=function(){return o.default.div({className:"u-mar-top-m clearfix"},o.default.div({className:"u-l-fr"},o.default.button({className:"c-btn c-btn--primary",disabled:!t._isValid(),onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.folderPath,t._setError)}},c.intl.formatMessage({id:"vJgZg+",defaultMessage:"Next"}))),o.default.div({className:"u-l-fl"},o.default.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),r.Modal.close(),"function"==typeof t.props.onBack?t.props.onBack():void 0}},c.intl.formatMessage({id:"tSs2ty",defaultMessage:"Back"}))))},t.renderSpectrumPrimaryButton=function(){return a.default.createElement("div",{className:"u-l-fr"},a.default.createElement(d.Button,{variant:"primary",disabled:!t._isValid(),onClick:t.onSubmit},c.intl.formatMessage({id:"vJgZg+",defaultMessage:"Next"})))},t.onSubmit=function(e){return"function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),t.props.onSubmit(t.state.folderPath,t._setError)},t.onBack=function(){return r.Modal.close(),t.props.onBack&&t.props.onBack()},t._setFolderPath=function(e){return t.setState({folderPath:e,errorMsg:void 0})},t._setError=function(e){var n;return t.setState({errorMsg:null===(n=null==e?void 0:e.path)||void 0===n?void 0:n.message_text})},t._isValid=function(){return null!=t.state.folderPath&&null==t.state.errorMsg},t}return n.__extends(t,e),t.prototype.render=function(){return a.default.createElement(u.UtilityModal,{primaryAction:this.renderSpectrumPrimaryButton,link:c.intl.formatMessage({id:"tSs2ty",defaultMessage:"Back"}),onLink:this.onBack,onRequestClose:this.onModalCloseClick,overlayClassName:"existing-shared-folder-wizard__overlay",overlayClickClose:!0,ariaLabel:c.intl.formatMessage({id:"XkbjSU",defaultMessage:"Shared Existing Folder Modal"}),className:"existing-shared-folder-wizard",open:this.state.open,displayCloseButton:!0,title:this.getTitle(this.props.user.role)},this.renderSpectrumContent())},t.displayName="ShareExistingFolderWizardModalNoCss",t})(a.default.Component);t.ShareExistingFolderWizardModal=i.requireCssWithComponent(m,["/static/css/sharing/wizard_modals-vflx-yihK.css"])})),define("modules/clean/sharing/wizard/wizard_modals",["require","exports","tslib","react","modules/clean/css","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/share_modal_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/clean/sharing/async_share_modal_util","modules/clean/web_user_action_events","modules/clean/web_user_action_logger"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g,f,h,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o),r=n.__importStar(r),l=n.__importDefault(l);var E=function(e,t,n,a){return new u.SharingApi(e).validate_shareable_existing_sf_path(t,(function(){return f.asyncShowShareModal(e,{fqPath:t,isFolder:!0,exists:!0,origin:d.SHARE_ACTION_ORIGIN_TYPE.WIZARD,modalSessionId:null!=a?a:void 0})}),(function(e){var t=l.default.extract_errors(e.responseText);return!1===t?void 0:"string"==typeof t?_.sharingNotificationError(t):"function"==typeof n?n(t):void 0})),Promise.resolve(!0)};t.shareExistingFolder=E;function y(e){if(i.EmailVerification.get_for_user(e).verified_or_show(r.SHARE_FOLDER)){o.require_css("/static/css/scooter/scooter-scoped-vfl5wRSGl.css");var t=m.generateModalSessionId();return s.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:t}),e.is_cdm_member?f.asyncShowNewFolderShareModal(e,t,e.cdm_tmf_path):(function(e,t){c.Modal.showInstance(a.default.createElement(p.ShareAFolderWizardModal,{user:e,onSubmit:function(n){null!=t&&s.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:n,modalSessionId:t});var o=n.slice(0,n.indexOf("-"));return v.WebUserActionLog.log(e.id,h.WebUserActionLogEvent.SELECT_FOLDER_TYPE,{folder_type:o}),"new-folder"===n?f.asyncShowNewFolderShareModal(e,t,e.cdm_tmf_path):"existing-folder"===n?(function(e,t,n){return null!=n&&s.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:n}),c.Modal.showInstance(a.default.createElement(g.ShareExistingFolderWizardModal,{user:e,onBack:t,onSubmit:function(t,a){return null!=n&&s.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:n}),E(e,t,(function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return null!=n&&s.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:n}),a.apply(void 0,Array.from(t||[]))}))}}))})(e,(function(){return y(e)}),t):void 0}}))})(e,t),t}}t.showShareAFolderWizardModal=y})),define("modules/clean/react/home/recommended_members/recommended_member_card",["require","exports","tslib","react","modules/core/user_i18n","dig-components/avatar","dig-components/buttons","dig-components/icons","dig-components/icons/src","modules/clean/react/css","modules/core/i18n"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o),t.RecommendedMemberAvatar=function(e){var t=e.photoUrl,n=e.name,r=o.getInitials(n);return a.default.createElement(i.Avatar,{size:"large",src:t||"",backgroundColor:i.avatarColorForUserIdentifier(r)},r)};var d=(function(e){function o(t){return e.call(this,t)||this}return n.__extends(o,e),o.prototype.componentDidMount=function(){this.props.onRecommendationCardShown()},o.prototype.render=function(){var e=this.props,n=e.buttonText,o=e.onButtonClick,i=e.recommendationReasons,c=e.email,d=e.name,m=e.onDismissClick,_=e.photoUrl,p="recommended-member-card";return a.default.createElement("article",{className:p},a.default.createElement("div",{className:p+"__top-bar"},a.default.createElement("div",{className:p+"__avatar"},a.default.createElement(t.RecommendedMemberAvatar,{name:d,photoUrl:_})),a.default.createElement("div",{className:p+"__user-context"},a.default.createElement("span",{className:p+"__title"},d),a.default.createElement("span",{className:p+"__email"},c)),a.default.createElement(r.IconButton,{variant:"transparent",className:p+"__dismiss",onClick:m},a.default.createElement(s.UIIcon,{src:l.CloseLine,"aria-label":u.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"})}))),a.default.createElement("div",{className:p+"__content"},a.default.createElement("ul",{className:p+"__suggestion-context"},i.map((function(e,t){return a.default.createElement("li",{key:t,className:p+"__text"},e)}))),a.default.createElement("div",{className:p+"__invite"},a.default.createElement(r.Button,{"aria-label":n,onClick:o,variant:"outline"},n))))},o.displayName="RecommendedMemberCard",o.defaultProps={isLoading:!1},o})(a.default.PureComponent);t.RecommendedMemberCard=c.requireCssWithComponent(d,["/static/css/dig-components/index.web-vflyKkT3N.css"])})),define("modules/clean/react/home/recommended_members/recommended_member_components",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls","modules/clean/react/image","modules/clean/react/home/section_header"],(function(e,t,n,a,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.RecommendedMembersHeader=function(e){var t=e.isHidden,n=e.buttonAction;return a.default.createElement(s.SectionHeader,{title:o.intl.formatMessage({id:"e9fyCS",defaultMessage:"Suggested members"}),ueName:"recommended",isHidden:t,onToggleHidden:n})},t.RecommendedMembersEmpty=function(){return a.default.createElement("article",{className:"recommended-members-empty"},a.default.createElement(r.Image,{className:"recommended-members-empty__img",src:i.static_url("/static/images/home/experiments/illustration_1x-vflq5p19x.png"),srcHiRes:i.static_url("/static/images/home/experiments/illustration_2x-vflGzU5Lp.png"),alt:o.intl.formatMessage({id:"yd60sv",defaultMessage:"happy face"})}),a.default.createElement("p",{className:"recommended-members-empty__text"},o.intl.formatMessage({id:"yzPd3d",defaultMessage:"That’s it for now. Thanks!"})))}})),define("modules/clean/react/home/recommended_members/recommended_members_post_tti",["require","exports","tslib","react","modules/core/i18n","modules/core/notify","modules/clean/viewer","modules/clean/react/modal","modules/clean/react/home/recommended_members/recommended_member_components","modules/clean/react/home/recommended_members/recommended_member_card","modules/clean/api_v2/user_client","modules/clean/analytics","modules/clean/react/home/recommended_members/utils","modules/clean/react/home/actions_post_tti"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.MIN_CARD_WIDTH=350,t.initPrefetchRecommendedMembers=function(){};var p=(function(p){function g(e){var n=p.call(this,e)||this;return n.logOrigin="home_recommended_members",n.onInviteError=function(e){i.Notify.error(o.intl.formatMessage({id:"vdYbD6",defaultMessage:"There was a problem completing this request."}))},n.onInviteSuccess=function(e){var t=n.state.recommendedMembers[e].email;i.Notify.success(o.intl.formatMessage({id:"NY7/41",defaultMessage:"Invited {email}"},{email:t})),n.hideCard(e)},n.onDismissMemberClick=function(e){var t=n.state.recommendedMembers[e];n.hideCard(e);var a=n.getSubjectUser();a&&(new u.UserApiV2Client).ns("team_experience").rpc("teammate_suggestions/dismiss",{teammate_id:t.user_id},{subjectUserId:a.id});d.TeamsWebActionsLogger.log("admin_dismiss_recommended_contact",{user_id:t.user_id,team_id:t.team_id,team_type:t.team_type,prediction_id:t.prediction_id,origin:n.logOrigin})},n.toggleModuleVisibility=function(){var e=n.props.isHiddenByUser;_.setSectionVisibilityPostTTI(n.getSubjectUser().id,{".tag":"recommended_members"},e)},n.hideCard=function(e){var t=n.state.recommendedMembers,a=t.slice(0,e).concat(t.slice(e+1));n.setState({recommendedMembers:a})},n.renderCards=function(e){var t=n.state.cardsToRender,i=e.slice(0,t).map((function(e,t){return a.default.createElement(c.RecommendedMemberCard,{key:e.user_id,recommendationReasons:m.getRecommendationContext(e,n.viewer),buttonText:o.intl.formatMessage({id:"bgAvOC",defaultMessage:"Invite to team"}),email:e.email,name:e.display_name,photoUrl:e.photo_url,onDismissClick:function(){n.onDismissMemberClick(t)},onButtonClick:function(){n.onInviteClick(t)},onRecommendationCardShown:function(){d.TeamsWebActionsLogger.log("admin_display_recommended_contact",{user_id:e.user_id,team_id:e.team_id,team_type:e.team_type,prediction_id:e.prediction_id,origin:n.logOrigin})}})}));return a.default.createElement("div",{className:"recommended-members__list"},i)},n.checkCardsToRender=function(){var e=n.props.containerWidth;return e<t.MIN_CARD_WIDTH?0:e<2*t.MIN_CARD_WIDTH?1:2},n.validateBrowserSize=function(){var e=n.state.cardsToRender,t=n.checkCardsToRender();e!==t&&n.setState({cardsToRender:t})},n.viewer=r.Viewer.get_viewer(),n.getSubjectUser()&&(n.actionHandler=new m.RecommendedMembersApiActionsHandler(n.viewer.work_user.id)),n.state={recommendedMembers:[],suggestId:void 0,cardsToRender:n.checkCardsToRender()},n}return n.__extends(g,p),g.prototype.componentDidMount=function(){var e=this;this.actionHandler&&(this.actionHandler.teammateSuggestionsList().then((function(t){var n=t.recommended_members.members.slice(0,2),a=t.suggest_id;e.setState({recommendedMembers:n,suggestId:a}),d.TeamsWebActionsLogger.log("admin_recommendations_shown",{user_id:e.viewer.get_uid_by_role("work"),team_id:e.viewer.team_id,num_recommendation:n.length,number_cards:e.state.cardsToRender,suggest_id:a})})),this.validateBrowserSize(),window.addEventListener("resize",this.validateBrowserSize))},g.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.validateBrowserSize)},g.prototype.getSubjectUser=function(){return this.viewer.work_user},g.prototype.onInviteClick=function(t){var o=this,i=this.state.recommendedMembers[t];new Promise((function(t,n){e(["modules/clean/teams/admin/widgets/invite_modal/invite_modal"],t,n)})).then(n.__importStar).then((function(e){var n=e.InviteModal;s.Modal.showInstance(a.default.createElement(n,{emails:[i.email],onInviteSuccess:function(){return o.onInviteSuccess(t)},onInviteError:function(){return o.onInviteError(t)},origin:o.logOrigin}))})),d.TeamsWebActionsLogger.log("admin_invite_recommended_contact",{user_id:i.user_id,team_id:i.team_id,team_type:i.team_type,prediction_id:i.prediction_id,origin:this.logOrigin})},g.prototype.render=function(){var e=this.state,t=e.recommendedMembers,n=e.cardsToRender,o=this.props.isHiddenByUser;return 0===n?null:a.default.createElement("div",{className:"recommended-members"},a.default.createElement(l.RecommendedMembersHeader,{isHidden:o,buttonAction:this.toggleModuleVisibility}),o?null:t.length>0?this.renderCards(t):a.default.createElement(l.RecommendedMembersEmpty,null))},g.displayName="RecommendedMembers",g})(a.default.Component);t.RecommendedMembers=p})),define("modules/clean/react/home/recommended_members/utils",["require","exports","modules/core/i18n","modules/clean/api_v2/user_client"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){var t=this;this.teammateSuggestionsList=function(){return t.apiClient.rpc("teammate_suggestions/list",void 0,{subjectUserId:t.userId}).then((function(e){return e}))},this.apiClient=(new a.UserApiV2Client).ns("team_experience"),this.userId=e};t.RecommendedMembersApiActionsHandler=o,t.getRecommendationContext=function(e,t){var a=[];return e.same_domain&&a.push(n.intl.formatMessage({id:"aQGRCZ",defaultMessage:"On your same email domain"})),e.known_collaborator_id===t.get_uid_by_role("work")?a.push(n.intl.formatMessage({id:"mNwU7J",defaultMessage:"Works with you a lot"})):0!==e.known_collaborator_id&&e.known_collaborator_display_name&&a.push(n.intl.formatMessage({id:"Y+RasF",defaultMessage:"Works with {collaborator} a lot"},{collaborator:e.known_collaborator_display_name})),e.num_team_shared_members>0&&a.push(n.intl.formatMessage({id:"gXOQCG",defaultMessage:"{count, plural, one{Collaborates with 1 person on your team} other{Collaborates with {count} people on your team}}"},{count:e.num_team_shared_members})),e.num_team_shared_folders>0&&a.push(n.intl.formatMessage({id:"wWppdC",defaultMessage:"{count, plural, one{In 1 shared folder with you} other{In {count} shared folders with you}}"},{count:e.num_team_shared_folders})),a.slice(0,3)}})),define("modules/clean/react/home/surface_teams_homepage/home_teams",["require","exports","tslib","react","classnames","modules/clean/react/home/actions_post_tti","modules/clean/react/home/store","modules/clean/react/home/surface_teams_homepage/home_teams_frame","modules/clean/react/teams/team_discovery/data/utils","modules/clean/react/teams/team_discovery/view/home_team_card","modules/clean/react/home/util/show_hide_link","modules/clean/react/home/surface_teams_homepage/home_teams_util","modules/clean/react/home/surface_teams_homepage/home_teams_logger"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),t.initPrefetchHomeTeams=function(){};var _=(function(e){function t(a){var o=e.call(this,a)||this;o.onRequestSubmit=function(e){o.setState({requestSubmitting:!0,userSelectedDbxTeamID:e})},o.onAcceptTeamInvite=function(e){o.setState({joiningTeam:!0});var t=o.state.teamInvitation;t?o.actionHandler.onAcceptTeamInvite(t):m.HomeTeamsLogger.getJoinStatus(e)===m.TeamJoinStatus.AUTO_JOIN&&(o.actionHandler.onJoinAutoJoinableTeam(e,o.updateJoinableTeams),o.logger.logClickedJoinForAutoJoinableTeam(e.id,o.state.joinableTeams))},o.onTeamDismiss=function(e){o.setState({dismissingTeam:!0});var t=o.state,a=t.teamInvitation,i=t.joinableTeams;o.actionHandler.onUserDismissedTeam(e,i,a).then((function(t){t&&(o.logger.logDismissTeam(e.id),o.setState(n.__assign(n.__assign({},t),{dismissingTeam:!1})))}))},o.onCancelPendingRequest=function(e){o.setState({cancellingRequest:!0}),o.actionHandler.onCancelPendingRequest(e,(function(){o.logger.logCancelRequestToJoin("manual",e),o.updateJoinableTeams()}))},o.joinTeamHandler=function(e){o.actionHandler.requestToJoin(e,o.logger.getExtraForRequestAccess(e)).then((function(t){t&&o.logger.logClickedReqToJoin(t,e),o.updateJoinableTeams()}))},o.updateJoinableTeams=function(){return o.actionHandler.getJoinableTeamsList().then((function(e){var t={requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1};if(e){var a=e.joinableTeams.find((function(e){return"waiting_for_approval"===e.joinTeamRequestState[".tag"]})),i=n.__assign(n.__assign(n.__assign({},e),t),{userSelectedDbxTeamID:null==a?void 0:a.dbxTeamId});o.setState(i)}else o.setState(t)}))},o.onChangeHomeTeamsVisibility=function(){var e=!o.props.isHiddenByUser;i.setSectionVisibilityPostTTI(o.userId,{".tag":"teams"},!e)},o.onToggleShowHide=function(){var e=!o.state.showAll;o.setState({showAll:e}),o.logger.logExpanderClicker()};var s=r.getUser();return o.userId=s.id,o.userDomain=-1!==s.email.indexOf("@")?s.email.split("@")[1]:void 0,o.role=r.getRole(),o.logger=new m.HomeTeamsLogger(o.userId,o.role),o.actionHandler=new d.HomeTeamsApiActionsHandler(o.userId),o.numberOfTeamsToDisplay=t.getNumberOfTeamsToDisplay(o.props.numberOfTeams),o.state={joinableTeams:[],requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1,showAll:!1,hasLoadedTeams:!1,userSelectedDbxTeamID:void 0,teamInvitation:void 0,windowWidth:window.innerWidth},o}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.updateJoinableTeams().then((function(){e.props.showTeamsLoadingState&&!e.props.isHiddenByUser&&e.logger.logExposedToSETOnHomepage(e.state.joinableTeams,e.state.teamInvitation)})),window.addEventListener("resize",(function(t){e.setState({windowWidth:window.innerWidth})}))},t.prototype.getHomeTeamCard=function(e){var n=this.state.teamInvitation;return void 0===e?null:a.default.createElement("div",{key:e.id},a.default.createElement(c.HomeTeamCard,{key:e.id,userSelectedDbxTeamID:this.state.userSelectedDbxTeamID,onRequestSubmit:this.onRequestSubmit,requestSubmitting:this.state.requestSubmitting,cancellingRequest:this.state.cancellingRequest,joiningTeam:this.state.joiningTeam,dismissingTeam:this.state.dismissingTeam,userHasMadeSelection:"waiting_for_approval"===e.joinTeamRequestState[".tag"],team:e,joinTeamHandler:this.joinTeamHandler,teamInvitation:void 0!==n&&n.team_id===e.id?n:void 0,onAcceptTeamInvite:this.onAcceptTeamInvite,onTeamDismiss:this.onTeamDismiss,onCancelPendingRequest:this.onCancelPendingRequest,isMobile:this.state.windowWidth<t.DEFAULT_MOBILE_WIDTH,userDomain:this.userDomain}))},t.prototype.renderHomeTeamsContainer=function(e){var t=this;if(e)return null;if(!this.state.hasLoadedTeams)return a.default.createElement(s.HomeTeamsSpinner,null);if(0===this.state.joinableTeams.length)return a.default.createElement(s.HomeTeamsEmptyState,null);var n=this.state,o=n.teamInvitation,i=n.joinableTeams,r=n.userSelectedDbxTeamID,l=n.requestSubmitting;if(void 0!==o){var c=i.find((function(e){return e.id===o.team_id}));return this.getHomeTeamCard(c)}if(void 0!==r&&!l){var u=i.find((function(e){return e.dbxTeamId===r}));return this.getHomeTeamCard(u)}var d=0,m=this.state.joinableTeams.map((function(e){return(d<t.numberOfTeamsToDisplay||t.state.showAll)&&t.props.showTeamsLoadingState&&!t.props.isHiddenByUser&&t.logger.logTeamExposedToSETOnHomepage(e),d++,t.getHomeTeamCard(e)}));return this.state.showAll||this.state.joinableTeams.length<=this.numberOfTeamsToDisplay?a.default.createElement("ul",{className:"home-teams-list"},m):a.default.createElement("ul",{className:"home-teams-list"},m.slice(0,this.numberOfTeamsToDisplay))},t.prototype.render=function(){var e,t;if(!this.props.canRenderItems||!this.props.showTeamsLoadingState||!this.props.showTeamsOnHomepageExperiment)return null;var n=(null===(t=this.state.joinableTeams)||void 0===t?void 0:t.length)-this.numberOfTeamsToDisplay,i=this.props.isHiddenByUser,r=this.state,c=r.hasLoadedTeams,d=r.joinableTeams,m=r.showAll,_=r.userSelectedDbxTeamID,p=r.teamInvitation,g=r.requestSubmitting,f=(!c||d.length>0)&&(!m||d.length<=this.numberOfTeamsToDisplay)&&(void 0===_||g)&&void 0===p&&!i,h=n>0&&!i&&!m&&(void 0===_||g)&&void 0===p,v=o.default(((e={})["home-teams-frame"]=f,e["home-teams-loading-view"]=!c,e["home-teams-no-list-style"]=!0,e));return a.default.createElement(s.HomeTeamsFrame,null,a.default.createElement(s.HomeTeamsHeader,{isHiddenByUser:i,buttonAction:this.onChangeHomeTeamsVisibility,userDomain:this.userDomain,useCollabTeamsTooltip:l.shouldShowTeamCollabContext(d)}),a.default.createElement("div",{className:v},a.default.createElement("div",{key:"teams"},this.renderHomeTeamsContainer(i)),a.default.createElement("div",{key:"showMore"},h?a.default.createElement(u.ShowHideLink,{hiddenItemCount:n,canLoadMore:!1,onClick:this.onToggleShowHide,isExpanded:m}):null)))},t.displayName="HomeSurfaceExistingTeams",t.DEFAULT_NUM_TEAMS_TO_SHOW=2,t.DEFAULT_MOBILE_WIDTH=480,t.getNumberOfTeamsToDisplay=function(e){return 1===e?1:t.DEFAULT_NUM_TEAMS_TO_SHOW},t})(a.default.Component);t.HomeTeams=_})),define("modules/clean/react/home/surface_teams_homepage/home_teams_frame",["require","exports","tslib","react","dig-components/icons","dig-components/icons/src","dig-components/tooltips","dig-components/progress_indicators","dig-components/typography","modules/clean/react/home/section_header","modules/core/i18n"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.HomeTeamsHeader=function(e){var t=e.isHiddenByUser,n=e.buttonAction,s=e.userDomain,l=e.useCollabTeamsTooltip,d=u.intl.formatMessage({id:"kQ/XqS",defaultMessage:"Suggested based on your company email address."});return l?d=u.intl.formatMessage({id:"Cjp7Qo",defaultMessage:"People we think you work with have joined one of these teams."}):void 0!==s&&(d=u.intl.formatMessage({id:"eJgRkU",defaultMessage:"Suggested because other people with an @{domain} email have joined one of these teams."},{domain:s})),a.default.createElement(c.SectionHeader,{title:u.intl.formatMessage({id:"qB+2aM",defaultMessage:"Join a team"}),ueName:"teams",isHidden:t,onToggleHidden:n,infoIcon:a.default.createElement(r.Tooltip,{placement:"right",title:d},a.default.createElement("div",null,a.default.createElement(o.UIIcon,{src:i.InfoLine})))})},t.HomeTeamsFrame=function(e){var t=e.children;return a.default.createElement("section",{className:"home-access-section"},t)},t.HomeTeamsEmptyState=function(){return a.default.createElement(l.Text,{color:"faint",className:"home-access-section__empty",tagName:"p"},u.intl.formatMessage({id:"MeG6h+",defaultMessage:"That's it for now. We'll suggest teams if we think they might be a good match."}))},t.HomeTeamsSpinner=function(){return a.default.createElement(s.Spinner,{size:"small","aria-valuetext":u.intl.formatMessage({id:"ZV8oAs",defaultMessage:"Loading teams you can join"})})}})),define("modules/clean/react/home/surface_teams_homepage/home_teams_actions",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons","dig-components/typography"],(function(e,t,n,a,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){var e=null,t=o.intl.formatMessage({id:"jggo6V",defaultMessage:"Join team now"});this.props.isMobile&&(t=o.intl.formatMessage({id:"xj5uap",defaultMessage:"Join team"}));var n=this.props,s=n.team,c=n.userSelectedDbxTeamID,u=n.requestSubmitting,d=n.cancellingRequest,m=n.teamHasInvitedUser,_=n.handleJoinButtonPress,p=n.handleInviteAccept,g=n.handleCancelPendingRequest;if(u&&s.dbxTeamId===c){var f=o.intl.formatMessage({id:"UFHFaL",defaultMessage:"Requesting..."});e=a.default.createElement(l,{requestSubmitting:u,handleJoinButtonPress:_,text:f})}else if(m)e=a.default.createElement(l,{requestSubmitting:u,handleJoinButtonPress:p,text:t});else switch(this.props.team.joinTeamRequestState[".tag"]){case"can_auto_join":e=a.default.createElement(l,{requestSubmitting:u,handleJoinButtonPress:p,text:t});break;case"request_rejected_open":case"request_rejected_dismissed":var h=o.intl.formatMessage({id:"9UmkJy",defaultMessage:"Your request to join was declined"});e=a.default.createElement(r.Text,{tagName:"div",color:"faint"},h);break;case"waiting_for_approval":var v=void 0;v=d?o.intl.formatMessage({id:"Zzad7F",defaultMessage:"Cancelling..."}):o.intl.formatMessage({id:"NCBimA",defaultMessage:"Cancel request"}),e=a.default.createElement(i.Button,{variant:"transparent",onClick:g,disabled:d},a.default.createElement("span",null,v));break;default:var E=o.intl.formatMessage({id:"7w7C+H",defaultMessage:"Ask to join"});e=a.default.createElement(l,{requestSubmitting:u,handleJoinButtonPress:_,text:E})}return a.default.createElement("div",{className:"home-teams-item__actions"},a.default.createElement("div",{className:"home-teams-item__actions-inner"},e))},t})((a=n.__importDefault(a)).default.PureComponent);t.HomeTeamsCardJoinButtons=s;var l=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){return a.default.createElement(i.Button,{size:"standard",onClick:this.props.handleJoinButtonPress,variant:"outline",disabled:this.props.requestSubmitting},a.default.createElement("span",null,this.props.text))},t})(a.default.PureComponent);t.HomeTeamsButtonWithText=l})),define("modules/clean/react/teams/team_discovery/view/home_team_card",["require","exports","tslib","react","classnames","modules/clean/react/teams/team_discovery/redesigned/view/team_card","modules/core/i18n","spectrum/button","spectrum/facepile","dig-components/badges","dig-components/icons","dig-components/icons/src","dig-components/typography","modules/clean/react/teams/team_discovery/data/utils","modules/clean/react/home/surface_teams_homepage/home_teams_actions"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o);var g=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleJoinButtonPress=function(){var e=n.props,t=e.team,a=e.joinTeamHandler;n.props.onRequestSubmit(t.dbxTeamId),a(t)},n.handleTeamDismiss=function(){n.props.onTeamDismiss(n.props.team)},n.handleCancelPendingRequest=function(){n.props.onCancelPendingRequest(n.props.team)},n.handleInviteAccept=function(){n.props.onAcceptTeamInvite(n.props.team)},n.userRequestedToJoinTeam=function(){return n.props.userSelectedDbxTeamID===n.props.team.dbxTeamId&&!n.props.requestSubmitting},n.shouldDisableDismiss=function(){var e=n.props,t=e.team,a=e.teamInvitation;return"waiting_for_approval"===t.joinTeamRequestState[".tag"]||void 0!==a},n.shouldRenderAvatars=function(){var e=n.props,t=e.team,a=e.teamInvitation,o=t.joinTeamRequestState[".tag"];return"waiting_for_approval"!==o&&"request_rejected_open"!==o&&void 0===a},n.isRequestDeclined=function(){return"request_rejected_open"===n.props.team.joinTeamRequestState[".tag"]},n.useCollabContextLayout=function(){var e=n.props,t=e.team,a=e.teamInvitation,o=t.joinTeamRequestState[".tag"];return _.shouldShowTeamCollabContext(t)&&!n.userRequestedToJoinTeam()&&void 0===a&&["can_auto_join","approval_required"].includes(o)},n.getAvatars=function(){if(!n.shouldRenderAvatars())return null;var e,t=n.props,o=t.isMobile,r=t.team,s=n.useCollabContextLayout();e=s?r.members.slice(0,4):r.members;var c=r.membersCount-e.length,u=a.default.createElement(l.FacepileMembers,{remainderCount:c>0?c.toString():void 0,remainderTooltipProps:{backgroundColor:"#344063",tooltipContent:a.default.createElement("div",null,c+" others")},isRemainderActive:!1,members:e.map(i.TeamCard.toFacepileMember),avatarSize:24,onAvatarClick:function(){},onAvatarMouseEnter:function(){},onAvatarMouseLeave:function(){}});return u=s?a.default.createElement("div",{className:"home-teams-item__facepile-container"},a.default.createElement("span",{className:"home-teams-item__facepile","data-testid":"member-facepile"},u),a.default.createElement("span",{className:"home-teams-item__team-admin"},a.default.createElement(m.Text,{color:"faint"},_.getAdminNamesStrForTeam(r)))):a.default.createElement("div",{"data-testid":"member-facepile"},u),o?a.default.createElement("div",{className:"home-teams-item__avatar-mobile"},u):u},n.getButtonActions=function(){return a.default.createElement(p.HomeTeamsCardJoinButtons,{team:n.props.team,userSelectedDbxTeamID:n.props.userSelectedDbxTeamID,requestSubmitting:n.props.requestSubmitting||n.props.joiningTeam||n.props.dismissingTeam,cancellingRequest:n.props.cancellingRequest,handleJoinButtonPress:n.handleJoinButtonPress,teamHasInvitedUser:void 0!==n.props.teamInvitation,handleInviteAccept:n.handleInviteAccept,handleCancelPendingRequest:n.handleCancelPendingRequest,isMobile:n.props.isMobile})},n.getDismissButton=function(){var e,t,i=n.shouldDisableDismiss(),r=o.default(((e={})["home-teams__button-middle"]=!0,e["home-teams-item__dismiss-invisible"]=i,e)),l=o.default(((t={})["home-teams-item__actions"]=!0,t["home-teams-item__actions-no-padding"]=i,t));return a.default.createElement("div",{className:l},a.default.createElement("div",{className:"home-teams-item__actions-inner"},a.default.createElement("div",{className:"home-teams-item__dismiss"},a.default.createElement(s.Button,{variant:"styleless",className:r,onClick:n.handleTeamDismiss,disabled:i||n.props.requestSubmitting||n.props.dismissingTeam,"data-testid":"dismiss-button"},a.default.createElement(u.UIIcon,{className:"home-teams__button-background",src:d.CloseLine,size:"standard"})))))},n.getCollabContextTeamHeader=function(){var e=n.props,t=e.isMobile,o=e.team,i=e.userDomain,r=null;o.isSameDomain&&i&&(r=a.default.createElement("span",{className:"home-teams-item__team-domain-badge"},n.getTeamSharesUserDomainBadge(i)));var s=null;return t&&!n.shouldDisableDismiss()&&(s=a.default.createElement("span",{className:"home-teams-item__auto-left"},n.getDismissButton())),a.default.createElement("div",null,a.default.createElement("span",{className:"home-teams-item__team-name"},a.default.createElement(m.Text,{tagName:"h3",isBold:!0},o.name),s),r)},n.getCollabContextDescriptionPoints=function(){var e=n.props.team,t=[];if(void 0!==e.sharedFolderCount&&e.sharedFolderCount>0&&t.push(_.getSharedFolderCountStr(e.sharedFolderCount)),void 0!==e.lastShareTimestamp&&t.push(_.getLastShareTimeStr(e.lastShareTimestamp)),0===t.length)return null;var o=t.map((function(e,t){return a.default.createElement(m.Text,{key:t,tagName:"li"},e)}));return a.default.createElement("ul",{className:"home-teams-item__team-context-list"},o)},n.getCollabContextTeamDescription=function(){var e=n.props.isMobile;return a.default.createElement("div",{className:"home-teams-item__team-description"},n.getCollabContextTeamHeader(),e?n.getAvatars():null,n.getCollabContextDescriptionPoints())},n.getCollabContextTeamActions=function(){var e=n.props.isMobile;return a.default.createElement("div",{className:"home-teams-item__avatar-and-actions"},e?null:n.getAvatars(),n.getButtonActions(),e?null:n.getDismissButton())},n.getTeamDescription=function(){var e=n.props,t=e.isMobile,o=e.team,i=n.isRequestDeclined(),r=a.default.createElement(m.Text,{tagName:"h3"},o.name),s=a.default.createElement(m.Text,{color:"faint"},n.getAdminNamesStr());return a.default.createElement("div",{className:"home-teams-item__team-description"},r,t&&i?null:s,t?n.getAvatars():null,t&&i?a.default.createElement("div",null,n.getButtonActions()):null)},n.getTeamActions=function(){var e=n.props.isMobile;return a.default.createElement("div",{className:"home-teams-item__avatar-and-actions"},e?null:n.getAvatars(),e&&n.isRequestDeclined()?null:n.getButtonActions(),e&&n.shouldDisableDismiss()?null:n.getDismissButton())},n}return n.__extends(t,e),t.prototype.getAdminNamesStr=function(){var e=this.props.team;if(this.props.teamInvitation)return r.intl.formatMessage({id:"As2n1+",defaultMessage:"Invited by {name}"},{name:this.props.teamInvitation.inviting_user_name});if(this.userRequestedToJoinTeam())return this.props.team.joinRequestStateDate?r.intl.formatMessage({id:"+4exZC",defaultMessage:"Asked to join on {date}"},{date:t.getDateFromTimeStamp(this.props.team.joinRequestStateDate)}):r.intl.formatMessage({id:"ABuPQv",defaultMessage:"Asked to join"});var n=e.members.filter((function(e){return e.isAdmin}))[0];return r.intl.formatMessage({id:"khtMbr",defaultMessage:"{admin_count, plural, one { Team admin: {admin_name}.} other { Team admins: {admin_name} +{admin_remainder_count} more.}}"},{admin_name:n.name,admin_remainder_count:e.adminsCount-1,admin_count:e.adminsCount})},t.getDateFromTimeStamp=function(e){var t=new Date(e);return r.intl.formatDate(t,{month:"long",day:"numeric",year:"numeric"})},t.prototype.getTeamSharesUserDomainBadge=function(e){var t=r.intl.formatMessage({id:"AUEkPL",defaultMessage:"Email match: <span>{emailDomain}</span>"},{span:function(e){return a.default.createElement("strong",{key:"user-domain"},e)},emailDomain:"@"+e});return a.default.createElement(c.AccessoryBadge,null,t)},t.prototype.render=function(){var e,t,n,i,r,s,l=this.props,c=l.isMobile,m=l.teamInvitation,_=this.useCollabContextLayout();_?(r=this.getCollabContextTeamDescription(),s=this.getCollabContextTeamActions()):(r=this.getTeamDescription(),s=this.getTeamActions());var p=o.default(((e={})["home-teams-item"]=!0,e["home-teams-item__content"]=!0,e["home-teams-item__approved-stripe"]=void 0!==m,e)),g=o.default(((t={})["home-teams-item__team-content"]=!c||!_,t["home-teams-item__team-content-mobile"]=c&&_,t)),f=o.default(((n={})["home-teams-item__team-text"]=_,n)),h=o.default(((i={})["home-teams-item__team-actions"]=!0,i["home-teams-item__team-actions-mobile"]=c&&_,i));return a.default.createElement("div",{className:p},a.default.createElement("div",{key:"icon"},a.default.createElement("div",{className:"home-teams-item__icon"},a.default.createElement(u.UIIcon,{src:d.TeamLine,size:"standard"}))),a.default.createElement("div",{key:"team-content",className:g},a.default.createElement("div",{key:"team-text",className:f},r),a.default.createElement("div",{key:"avatars-and-actions",className:h},s)))},t})(a.default.PureComponent);t.HomeTeamCard=g})),define("modules/clean/react/teams/team_discovery/redesigned/view/team_card",["require","exports","tslib","react","classnames","external/lodash","modules/core/i18n","spectrum/facepile/facepile_members","modules/clean/react/teams/team_discovery/data/utils","modules/clean/static_urls","modules/clean/react/image","dig-components/badges","dig-components/controls","dig-components/icons","dig-components/icons/src","dig-components/typography"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),i=n.__importStar(i);var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getAdminNamesStr=function(){var e=this.props.team,t=i.filter(e.members,(function(e){return e.isAdmin}))[0];return r.intl.formatMessage({id:"khtMbr",defaultMessage:"{admin_count, plural, one { Team admin: {admin_name}.} other { Team admins: {admin_name} +{admin_remainder_count} more.}}"},{admin_name:t.name,admin_remainder_count:e.adminsCount-1,admin_count:e.adminsCount})},t.prototype.getTeamSharesUserDomainNode=function(e){return r.intl.formatMessage({id:"S7nPs7",defaultMessage:"Team members have <span>{emailDomain}</span> emails"},{span:function(e){return a.default.createElement(d.AccessoryBadge,{key:"user-domain"},a.default.createElement("strong",null,e))},emailDomain:"@"+e})},t.prototype.getTeamDescriptionWithCollabContext=function(){var e=this.props,t=e.team,n=e.userDomain,o=[];t.isSameDomain&&void 0!==n&&n.length>0&&o.push(this.getTeamSharesUserDomainNode(n)),void 0!==t.sharedFolderCount&&t.sharedFolderCount>0&&o.push(l.getSharedFolderCountStr(t.sharedFolderCount)),void 0!==t.lastShareTimestamp&&o.push(l.getLastShareTimeStr(t.lastShareTimestamp));var i=o.map((function(e,t){return a.default.createElement(g.Text,{key:t,tagName:"li"},e)}));return a.default.createElement(a.default.Fragment,null,this.getFacepile(4),a.default.createElement(g.Text,{color:"faint"},l.getAdminNamesStrForTeam(t)),a.default.createElement("hr",null),a.default.createElement("div",{className:"team-discovery-page-redesigned__team-card-description"},a.default.createElement("ul",null,i)))},t.toFacepileMember=function(e){return{memberKey:e.memberId.toString(),active:!0,alt:null,avatarColorSeed:e.memberId.toString(),initials:e.name.charAt(0),photoUrl:void 0===e.avatarURL?null:e.avatarURL,tooltipContent:a.default.createElement("div",null,e.name)}},t.prototype.getFacepile=function(e){var n=this.props.team;e=null!=e?e:n.members.length;var o=n.membersCount-e;return a.default.createElement("div",{className:"team-discovery-page-redesigned__team-card-facepile","data-testid":"member-facepile"},a.default.createElement(s.FacepileMembers,{remainderCount:o>0?o.toString():void 0,remainderTooltipProps:{backgroundColor:"#344063",tooltipContent:a.default.createElement("div",null,o+" others")},isRemainderActive:!1,members:n.members.slice(0,e).map(t.toFacepileMember),avatarSize:32,shadowBackgroundColor:"#f7f9fa",onAvatarClick:function(){},onAvatarMouseEnter:function(){},onAvatarMouseLeave:function(){}}))},t.prototype.getDescriptionAndFacepile=function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"team-discovery-page-redesigned__team-card-description"},this.getAdminNamesStr()),this.getFacepile())},t.prototype.render=function(){var e=this.props,t=e.team,n=e.checked,i=e.onSelectionChanged,r=e.showRedactedTeamCard,s=l.shouldShowTeamCollabContext(t),d=null,f=a.default.createElement("div",{className:"team-discovery-page-redesigned__team-card-team-name"},t.name),h=a.default.createElement(u.Image,{className:"team-discovery-page-redesigned__team_card-building-icon",src:c.static_url("/static/images/team_discovery/building-vflji5Gxx.png"),srcHiRes:c.static_url("/static/images/team_discovery/building-icon@2x-vflRJs5ej.png")});s?(d=this.getTeamDescriptionWithCollabContext(),f=a.default.createElement(g.Title,{className:"team-discovery-page-redesigned__team-card-team-name-collab",size:"small",isBold:!0},t.name),h=a.default.createElement(_.UIIcon,{className:"team-discovery-page-redesigned__team_card-building-icon-collab",src:p.TeamLine})):r||(d=this.getDescriptionAndFacepile());var v="team-discovery-page-redesigned__team_card-check-container",E="team-discovery-page-redesigned__team-card-check-box",y="team-discovery-page-redesigned__team-card";return r?(v+="-redacted",E+="-redacted",y+="-redacted"):s&&(E+="-collab"),a.default.createElement("div",{className:o.default(y,{"team-card-selected":n}),onClick:function(){return i(t)}},a.default.createElement("div",{className:v},a.default.createElement(m.Checkbox,{className:E,checked:n,"aria-label":"Keep team shares",readOnly:!0})),a.default.createElement("div",{className:"team-discovery-page-redesigned__team_card-contents"},h,f,d))},t})(a.default.PureComponent);t.TeamCard=f})),define("modules/clean/react/home/surface_teams_homepage/home_teams_util",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/react/teams/team_discovery/data/model","modules/core/notify","modules/core/i18n","modules/core/uri","modules/core/browser","modules/clean/react/teams/team_discovery/data/logger","modules/clean/react/home/surface_teams_homepage/home_teams_logger"],(function(e,t,n,a,o,i,r,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=n.__importStar(l);var d=(function(){function e(t){var s=this;this.requestToJoin=function(t,n){return s.apiClient.rpc("joinable_teams/join",{team_id:t.id,dbx_team_id:t.dbxTeamId,extra:n,source:u.HomeTeamsSource},{subjectUserId:s.userId}).then((function(t){return"request_sent"===t.result[".tag"]||"can_join"===t.result[".tag"]?i.Notify.success(r.intl.formatMessage({id:"mpAhES",defaultMessage:"Request sent successfully."})):i.Notify.error(e.DEFAULT_ERROR_CONTACT_ADMIN),t.result[".tag"]})).catch((function(t){i.Notify.error(e.DEFAULT_ERROR_CONTACT_ADMIN)}))},this.getJoinableTeamsList=function(){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(t){return[2,this.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:this.userId}).then((function(e){return{joinableTeams:e.values.map(o.toJoinableTeam),teamInvitation:e.team_invite,hasLoadedTeams:!0}})).catch((function(t){i.Notify.error(e.DEFAULT_ERROR_REFRESH_PAGE)}))]}))}))},this.apiClient=(new a.UserApiV2Client).ns("team_discovery"),this.userId=t}return e.prototype.onAcceptTeamInvite=function(e){var t=new s.URI({path:"/"}).toString(),n={signup_key:e.signup_key,cont:t},a=new s.URI({path:"/team/join",query:n}).toString();l.redirect(a)},e.prototype.onJoinAutoJoinableTeam=function(e,t){this.apiClient.rpc("joinable_teams/join",{team_id:e.id,dbx_team_id:e.dbxTeamId},{subjectUserId:this.userId}).then((function(e){"can_join"===e.result[".tag"]?l.redirect(e.result.url):t()}))},e.prototype.onUserDismissedTeam=function(t,n,a){var o=this;return this.apiClient.rpc("joinable_teams/dismiss",{team_id:t.id,dbx_team_id:t.dbxTeamId},{subjectUserId:this.userId}).then((function(){return o.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:o.userId}),{joinableTeams:n.filter((function(e){return e!==t})),teamInvitation:t.id===(null==a?void 0:a.team_id)?void 0:a}})).catch((function(t){i.Notify.error(e.DEFAULT_ERROR_REFRESH_PAGE)}))},e.prototype.onCancelPendingRequest=function(t,a){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.apiClient.rpc("joinable_teams/cancel_join",{team_id:t.id,source:c.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage},{subjectUserId:this.userId})];case 1:return n.sent(),a(),[3,3];case 2:return n.sent(),i.Notify.error(e.DEFAULT_ERROR_REFRESH_PAGE),[3,3];case 3:return[2]}}))}))},e.DEFAULT_ERROR_REFRESH_PAGE=r.intl.formatMessage({id:"tbMyDV",defaultMessage:"Something went wrong with the request, please refresh the page"}),e.DEFAULT_ERROR_CONTACT_ADMIN=r.intl.formatMessage({id:"td9Mz6",defaultMessage:"Something went wrong with the request, contact the admin"}),e})();t.HomeTeamsApiActionsHandler=d})),define("modules/clean/react/home/surface_teams_homepage/home_teams_logger",["require","exports","modules/clean/analytics","modules/clean/react/teams/team_discovery/data/logger"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;(function(e){e.DENIED="denied",e.APPROVED="approved",e.PENDING="pending",e.DEFAULT="default",e.AUTO_JOIN="can_auto_join"})(o=t.TeamJoinStatus||(t.TeamJoinStatus={})),t.HomeTeamsSource="home";var i=(function(){function e(e,t){this.userId=e,this.role=t}return e.getJoinStatus=function(e){switch(e.joinTeamRequestState[".tag"]){case"waiting_for_approval":return o.PENDING;case"request_rejected_open":case"request_rejected_dismissed":return o.DENIED;case"request_approved":return o.APPROVED;case"can_auto_join":return o.AUTO_JOIN;default:return o.DEFAULT}},e.prototype.logExposedToSETOnHomepage=function(t,a){for(var i=0,r=0,s=0,l=0,c=0,u=t;c<u.length;c++){var d=u[c];if((null==a?void 0:a.team_id)===d.id)l++;else switch(e.getJoinStatus(d)){case o.PENDING:i++;break;case o.DENIED:r++;break;case o.AUTO_JOIN:l++;break;default:s++}}n.TeamsWebActionsLogger.log("exposed_to_set_on_home_page",{num_of_teams:t.length,num_of_pending_teams:i,num_of_denied_teams:r,num_of_approved_teams:l,num_of_default_teams:s},(function(){}),this.userId)},e.prototype.logExpanderClicker=function(){n.TeamsWebActionsLogger.log("clicked_set_on_home_expander",{},(function(){}),this.userId)},e.prototype.logTeamExposedToSETOnHomepage=function(t){n.TeamsWebActionsLogger.log("exposed_to_set_on_home_team_card",{team_id:t.id,join_status:e.getJoinStatus(t),num_team_members:t.membersCount})},e.prototype.logClickedReqToJoin=function(o,i){n.TeamsWebActionsLogger.log("clicked_req_to_join",{reason:o,account_role:this.role,team_id:i.id,origin:a.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,join_state:e.getJoinStatus(i),url:"/h",user_plan_type:"basic"},(function(){}),this.userId)},e.prototype.getExtraForRequestAccess=function(e){return{num_team_members:e.membersCount.toString(),user_id:this.userId.toString(),origin:a.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:e.id.toString(),url:"/h"}},e.prototype.logClickedJoinForAutoJoinableTeam=function(t,a){for(var i=0,r=0,s=0,l=a;s<l.length;s++){var c=l[s],u=e.getJoinStatus(c);u===o.AUTO_JOIN?r++:u===o.DEFAULT&&i++}n.TeamsWebActionsLogger.log("clicked_join",{account_role:this.role,team_id:t,url:"/h",num_ask_to_join:i,num_auto_join:r},(function(){}),this.userId)},e.prototype.logCancelRequestToJoin=function(e,o){n.TeamsWebActionsLogger.log("cancel_request_to_join",{reason:e,num_team_members:o.membersCount,origin:a.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:o.id},(function(){}),this.userId)},e.prototype.logDismissTeam=function(e){n.TeamsWebActionsLogger.log("dismiss_team",{team_id:e,origin:a.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource},(function(){}),this.userId)},e})();t.HomeTeamsLogger=i})),define("modules/clean/upsell/home_inline_location",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","retrieval-components/collapsable-section","modules/core/browser","modules/core/i18n","modules/clean/api_v2/user_client","modules/clean/react/home/section_header","modules/clean/storage","modules/clean/upsell/prompt_event_emitter"],(function(e,t,n,a,o,i,r,s,l,c,u,d,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),l=n.__importStar(l),t.initPrefetchHomeInlineContentPrompt=function(){};var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={promptData:null},n}return n.__extends(t,e),t.prototype.listenForPromptData=function(){var e=this;_.promptBufferedEventEmitter.on(_.Events.ON_HOME_INLINE_CONTENT_LOADED,(function(t){e.setState({promptData:t})}))},t.prototype.componentDidMount=function(){this.listenForPromptData()},t.prototype.render=function(){var e=this.props,t=e.canRenderItems,a=e.isOnBrowse,i=this.state.promptData;return t&&i?o.default.createElement(g,n.__assign({isOnBrowse:a},i)):null},t.displayName="HomeInlineContentPrompt",t})(o.default.PureComponent);t.HomeInlineContentPrompt=p;var g=(function(t){function a(a){var o=t.call(this,a)||this;o.confirmPrompt=function(e){o.callStateManager((function(t){t.onConfirm(e)}));var t=o.props.campaign.content;l.redirect(t.confirmUrl)},o.dismissPrompt=function(e){o.callStateManager((function(t){t.onDismiss(e)}))},o.toggleSectionHidden=function(){o.setState((function(e){var t=!e.promptBodyHidden,n=o.props.subjectUser;return t?m.UserLocalStorage.set(n,o.localStorageItemName,1):m.UserLocalStorage.delete(n,o.localStorageItemName),{promptBodyHidden:t}}))};var i=a.subjectUser,r=a.campaign;return o.localStorageItemName="prompt_home_inline_content_hidden_"+r.campaignId,o.state={isConfirmed:!1,isDismissed:!1,isShown:!1,promptBodyHidden:null!==m.UserLocalStorage.get(i,o.localStorageItemName),renderPrevented:!0},o.stateManagerOnload=[],a.disableStateManager||new Promise((function(t,n){e(["modules/clean/react/prompt/campaign_state_manager"],t,n)})).then(n.__importStar).then((function(e){o.stateManager=new e.CampaignStateManager(o);for(var t=0,n=o.stateManagerOnload;t<n.length;t++){(0,n[t])(o.stateManager)}})),o}return n.__extends(a,t),a.prototype.preventRenderUntilSafe=function(e){var t;return n.__awaiter(this,void 0,void 0,(function(){var a,o,i,r,s,l=this;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,(new u.UserApiV2Client).ns("team_discovery").rpc("joinable_teams/list",{member_to_fetch_limit:1},{subjectUserId:e})];case 1:return a=n.sent(),!!(null===(t=null==a?void 0:a.values)||void 0===t?void 0:t.length)?[2]:(o=this.props.isOnBrowse,i=o?".maestro-app-content":".home-access-sections",!!document.querySelector(i+":hover")?(r=document.querySelector(i),s=function(){!!!document.querySelector(i+":hover")&&l.state.renderPrevented&&(l.setState({renderPrevented:!1}),r.removeEventListener("mouseout",s))},r.addEventListener("mouseout",s)):this.setState({renderPrevented:!1}),[2])}}))}))},a.prototype.callStateManager=function(e){this.props.disableStateManager||(this.stateManager?e(this.stateManager):this.stateManagerOnload.push(e))},a.prototype.componentDidUpdate=function(e,t){t.renderPrevented&&!this.state.renderPrevented&&this.callStateManager((function(e){e.onShow()}))},a.prototype.componentDidMount=function(){this.preventRenderUntilSafe(this.props.subjectUser),this.state.renderPrevented||this.callStateManager((function(e){e.onShow()}))},a.prototype.render=function(){var e=this.props,t=e.campaign,n=e.isOnBrowse,a=t.content,s=this.state,l=s.isDismissed,c=s.promptBodyHidden,u=s.renderPrevented,m=null;if(!c){var _=a.showDismissButton?o.default.createElement(i.Button,{variant:"transparent",onClick:this.dismissPrompt},a.dismissText):null;m=o.default.createElement(o.default.Fragment,null,o.default.createElement(r.Text,{tagName:"p",className:"home-inline-content-prompt__content"},a.text),o.default.createElement("div",{className:"home-inline-content-prompt__cta"},o.default.createElement(i.Button,{variant:"outline",onClick:this.confirmPrompt},a.confirmText),_))}return o.default.createElement(f,{visible:!u&&!l,isOnBrowse:!!n,title:a.titleText,promptBodyHidden:c,onToggleBodyHidden:this.toggleSectionHidden},n?null:o.default.createElement(d.SectionHeader,{title:a.titleText,ueName:"prompt",isHidden:c,onToggleHidden:this.toggleSectionHidden}),m)},a.displayName="HomeInlineContentPromptUI",a})(o.default.Component);t.HomeInlineContentPromptUI=g;var f=function(e){var t=e.children,n=e.visible,i=e.isOnBrowse,r=e.title,l=e.promptBodyHidden,u=e.onToggleBodyHidden;return i?o.default.createElement("div",{className:a.default("prompt-inline-content",{"prompt-inline-content__removed":!n})},o.default.createElement(s.CollapsableSection,{title:r,isOpen:!l,onHeaderClick:u,strings:{buttonClose:c.intl.formatMessage({id:"D8K+9v",defaultMessage:"Hide"}),buttonOpen:c.intl.formatMessage({id:"pDnAQ5",defaultMessage:"Show"})},containerClassName:"home-access-section__inline_prompt"},t)):o.default.createElement("section",{className:a.default({"prompt-inline-content":!0,"home-access-section":!0,"home-access-section__content":!0,"home-access-section__inline_prompt":!0,"home-access-section__removed":!n,"prompt-inline-content__removed":!n})},t)};f.displayName="PromptFrame",t.RootComponent=function(e){return o.default.createElement(p,n.__assign({},e))}}));
//# sourceMappingURL=pkg-home-post-tti.min.js-vfltMsCGn.map