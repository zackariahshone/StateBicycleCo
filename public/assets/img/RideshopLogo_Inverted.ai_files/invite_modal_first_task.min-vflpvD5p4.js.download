define(["require","exports","tslib","react","react-intl","spectrum/modal","modules/clean/ajax","modules/core/browser_detection","modules/core/i18n","modules/clean/ux_analytics_modal_tracking","modules/constants/page_load","modules/clean/react/css","modules/clean/react/growth/first_task/first_task","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_data","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_invite_content","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_list","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_sidebar","modules/clean/teams/admin/widgets/member_send_invite/member_invite_disclosure","modules/clean/react/table","modules/clean/viewer"],(function(e,t,a,i,s,n,o,r,l,m,d,c,u,_,f,v,b,p,g,h,M,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importDefault(i),o=a.__importStar(o),r=a.__importStar(r);var I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={memberActionsData:void 0},t.focusRef=i.default.createRef(),t}return a.__extends(t,e),t.prototype.loadMemberActionsData=function(e){var t=this.props,i=t.evhMaxDays,s=t.memberList,n=t.relaunchModal,r=t.updateMemberList,l={is_current:!0,limit:s.length,offset:0,sort_column:"user_type",sort_direction:M.TableSortDir.ASC};o.WebRequest({url:"/team/admin/members/list_v2",data:l,subject_user:w.Viewer.get_viewer().work_user,success:function(t){var o={},l=new Date((new Date).setDate(i||0)).toLocaleDateString();JSON.parse(t).members.forEach((function(e){var t=e.user_id;o[t]=a.__assign(a.__assign({},v.getMemberInviteActionsProperties(e,l)),{onClose:function(){n(s)},deleteCallback:function(){for(var e=0;e<s.length&&s[e].user_id!==t;e++);s.splice(e,1),n(s)},roleUpdateCallback:function(e){for(var i=0;i<s.length;i++)if(s[i].user_id===t){var n=a.__assign({},s[i]);n.admin_role=e,s[i]=n}r(s)}})}),{}),e(o)}})},t.prototype.componentDidMount=function(){var e=this,t={platform:this.props.loggingExtras.is_client?f.Platform.DESKTOP_SSCV:r.is_supported_mobile_browser()?f.Platform.MOBILE_WEB:f.Platform.WEB};f.SMBFunnelLogger.setCommonTags(t),f.SMBFunnelLogger.log(_.AMPMetrics.ACTIVATION_IMM_VIEW),this.loadMemberActionsData((function(t){e.setState({memberActionsData:t})}))},t.prototype.componentDidUpdate=function(e){var t=this;e.memberList.length!==this.props.memberList.length&&this.loadMemberActionsData((function(e){t.setState({memberActionsData:e})}))},t.prototype.render=function(){var e=this.props,t=e.open,a=e.tieredAdmin,o=e.memberList,r=e.showSidebar,c=e.emails,_=e.sentEmails,f=e.handleOnClose,v=e.onCSVImport,M=e.handleOnSubmit,I=e.handleCSVImport,S=e.renderInputForm,C=e.renderSubmitBtn,E=e.loggingExtras,A=e.showImportCSV,k=e.isInviteLinkEnabled,D=e.growthActSmbMWInvitesActive,y=e.showMemberInviteDisclaimer,L=e.role,T=D?"invite-modal-first-task-mobile":"invite-modal-first-task",O=w.Viewer.get_viewer(),W=O.work_user,x=O.team_id,V=O.team_name;if(!W||!x||!V)return null;var N=W.id,B=1===o.length||D?l.intl.formatMessage({id:"5dI3gl",defaultMessage:"Invite team members"}):l.intl.formatMessage({id:"WzCl9b",defaultMessage:"Manage team members"});return window.requestAnimationFrame((function(){if(y){var e=document.querySelector("."+T+"__content"),t=document.querySelector("."+T+"__member-invite-disclaimer"),a=t.offsetWidth-parseFloat(getComputedStyle(t,null).width.replace("px",""));t.style.width=e.offsetWidth-a+"px"}})),i.default.createElement(s.IntlProvider,{defaultLocale:"en-US",locale:l.localeToBcp47LangTag(d.USER_LOCALE)},i.default.createElement(n.Modal,{className:D?"mw-invites-modal-sheet":"",open:t,ariaLabel:l.intl.formatMessage({id:"Ntdwnu",defaultMessage:"Invite Members"}),displayCloseButton:!0,onRequestClose:function(){_.length&&u.showClinkTooltip(u.TooltipType.Members),f()},overlayClickClose:!0,width:r?960:699,overflowY:!0,focusedElementOnOpen:this.focusRef,appElement:document.body,bodyClassName:"invite-modal "+T+" "+(r?T+"--sidebar-visible":"")},i.default.createElement(m.UXAnalyticsModalTracking,{id:"invite-modal"}),i.default.createElement("div",{className:T+"__container"},i.default.createElement("div",{className:T+"__content"},i.default.createElement("div",{className:T+"__title"},B),i.default.createElement(b.InviteModalInviteContent,{baseClass:T,focusRef:this.focusRef,currentUser:W,handleOnSubmit:M,onCSVImport:v,handleCSVImport:I,renderInputForm:S,renderSubmitBtn:C,showImportCSV:A,isInviteLinkEnabled:k,growthActSmbMWInvitesActive:D}),i.default.createElement(p.InviteModalMemberList,{baseClass:T,currentUserId:N,teamId:x,teamName:V,tieredAdmin:a,memberList:o,memberActionsData:this.state.memberActionsData,handleOnClose:f,loggingExtras:E,growthActSmbMWInvitesActive:D,showMemberInviteDisclaimer:y}),y&&i.default.createElement("div",{className:T+"__member-invite-disclaimer"},i.default.createElement(h.MemberInviteDisclosure,{role:L}))),r&&i.default.createElement(g.InviteModalSidebar,{baseClass:T,memberList:o,emails:c,sentEmails:_}))))},t})(i.default.Component);t.FirstTaskInviteModalWithoutCss=I,t.FirstTaskInviteModal=c.requireCssWithComponent(I,["/static/css/dig-components/index.web-vflyKkT3N.css","/static/css/teams/admin/widgets/invite_modal/invite_modal_first_task-vflkO42Vo.css"])}));
//# sourceMappingURL=invite_modal_first_task.min.js-vflY8Tm0x.map