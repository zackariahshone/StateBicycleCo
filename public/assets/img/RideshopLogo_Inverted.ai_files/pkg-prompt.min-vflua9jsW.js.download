define("modules/clean/admin/megaphone/prompt/api/utils",["require","exports","modules/clean/admin/megaphone/prompt/api_interfaces"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){var t=function(e){return e.replace(/_(.)/g,(function(e,t){return t.toUpperCase()}))},r=function(e,t){if(null===t)return null;if(Array.isArray(t)){var n=[];return t.forEach((function(t){n.push(r(e,t))})),n}if("object"==typeof t){var o={};return Object.keys(t).forEach((function(n){o[e(n)]=r(e,t[n])})),o}return t};e.toCamelCase=function(e){return(function(e,t){return r(e,t)})(t,e)},e.jsonToCamelCase=function(t){var n=JSON.parse(t);return e.toCamelCase(n)},e.stringToCamelCase=function(e){return t(e)},e.toStoneBool=function(e){return{".tag":"bool",bool:e}},e.toStoneInt=function(e){return{".tag":"int",int:e}},e.toStoneString=function(e){return{".tag":"string",string:e}},e.toStoneStringList=function(e){return{".tag":"string_list",string_list:e}},e.fromStoneField=function(e,t){var r=e[".tag"];if(!r)throw"Improperly formatted Stone type: missing .tag";var o=void 0;switch(t){case n.FieldTypes.Bool:o="bool";break;case n.FieldTypes.Integer:o="int";break;case n.FieldTypes.String:o="string";break;case n.FieldTypes.ListOfStrings:o="string_list";break;default:o="string"}if(r!==o)throw"Stone type mismatch: "+r+" != "+o;return e[r]}})(t.APIUtils||(t.APIUtils={})),t.isVersion=function(e){return void 0!==e.id},t.isCreateVersionArg=function(e){return void 0===e.id},t.versionResultToUpdateVersionArg=function(e){return{id:e.id,content_dict:e.content_dict,description:e.description,name:e.name,stormcrow_variant:e.stormcrow_variant}},t.isAdActive=function(e){return!!e.ad&&!!e.ad.lifecycle_state&&"active"===e.ad.lifecycle_state[".tag"]},t.isCampaignArchived=function(e){return"archived"===e.lifecycle_state[".tag"]},t.isCampaignApproved=function(e){return"approved"===e.lifecycle_state[".tag"]},t.isVersionApproved=function(e){return"approved"===e.lifecycle_state[".tag"]},t.isVersionArchived=function(e){return"archived"===e.lifecycle_state[".tag"]},t.isVersionPending=function(e){return"pending_approval"===e.lifecycle_state[".tag"]},t.newIsVersionPending=function(e){var t=e.megaphone_version_metadata,n=t?t.approval_request:void 0;return"pending_approval"===e.lifecycle_state[".tag"]&&void 0!==n&&"pending_approval"===n.lifecycle_state[".tag"]},t.isVersionDraft=function(e){var t=e.megaphone_version_metadata,n=t?t.approval_request:void 0;return"pending_approval"===e.lifecycle_state[".tag"]&&(void 0===n||"draft"===n.lifecycle_state[".tag"])}})),define("modules/clean/react/prompt/header_bubble",["require","exports","tslib","react","modules/core/i18n","classnames","modules/clean/react/css","modules/clean/react/prompt/prompt_location","modules/clean/react/prompt/header_link","modules/clean/react/prompt/image","modules/clean/react/prompt/button","dig-components/buttons","dig-components/typography","modules/clean/react/prompt/prompt_button","modules/clean/react/prompt/prompt_tooltip"],(function(e,t,n,r,o,i,a,s,l,c,p,m,d,u,f){"use strict";function g(e){return u.PromptButton(e)}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i);var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.state_manager.onShow()},t.prototype.render=function(){return this.props.useDig2?this.renderDig2():this.renderNonDig()},t.prototype.renderDig2=function(){var e=this.props.campaign.content,t=r.default.createRef(),n=r.default.createRef(),a=e.imageUrl?r.default.createElement("div",{className:"image-container"},r.default.createElement(c.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText})):null,s=i.default({"prompt-header-bubble-tooltip":!0,"has-image":!!e.imageUrl});return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"prompt-boundary",ref:n}),r.default.createElement("li",{className:"top-level-nav-item active prompt-header-bubble"},r.default.createElement(l.HeaderLinkRendererWithoutCSS,{content:e,confirmUrl:this.state_manager.buildConfirmEndpointURI(),onConfirm:this.state_manager.onConfirm,linkRef:t,useDig2:this.props.useDig2}),r.default.createElement(f.PromptTooltip,{isOpen:!this.state.isDismissed&&!this.state.isConfirmed,isPreview:this.props.isPreview,className:s,placement:"bottom",isInverse:!1,targetRef:t,boundaryRef:this.props.boundaryRef||n},r.default.createElement("div",{className:"prompt-header-bubble-content"},a,r.default.createElement("div",{className:"content-container"},r.default.createElement(d.Text,{dangerouslySetInnerHTML:p.sanitizeOptionalHTML(e.text)}),r.default.createElement("div",{className:"prompt-buttons"},r.default.createElement(m.Button,{className:"cancel-button",variant:"opacity",onClick:this.state_manager.onDismiss},e.cancelText||o.intl.formatMessage({id:"tuKZQZ",defaultMessage:"Close"})),r.default.createElement(g,{variant:"primary",text:e.confirmText,url:this.state_manager.buildConfirmEndpointURI(),confirmInNewTab:e.confirmInNewTab||!1,confirmIsPost:this.state_manager.shouldConfirmUsingPost(),stateManager:this.state_manager,onClick:this.state_manager.onConfirm})))))))},t.prototype.renderNonDig=function(){var e=this.props.campaign.content,t=r.default.createElement("div",null,r.default.createElement("p",{className:"message",dangerouslySetInnerHTML:p.sanitizeOptionalHTML(e.text),ref:this.state_manager.enhanceHTMLButtons}),r.default.createElement(p.PromptButtons,{campaign:this.props.campaign,confirmIsPost:this.state_manager.shouldConfirmUsingPost(),confirmUrl:this.state_manager.buildConfirmEndpointURI(),onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss})),n=i.default({"header-bubble-container":!0,show:!0,"header-bubble-container--with-image":!!e.imageUrl}),o=e.imageUrl?[r.default.createElement("div",{className:"left"},r.default.createElement(p.ConfirmButton,{className:"image-button",confirmInNewTab:e.confirmInNewTab,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),onConfirm:this.state_manager.onConfirm},r.default.createElement(c.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText}))),r.default.createElement("div",{className:"right"},t)]:[t],a=["top-level-nav-item"];return this.state.isConfirmed||this.state.isDismissed||a.push("active"),r.default.createElement("li",{className:a.join(" ")},r.default.createElement(l.HeaderLinkRendererWithoutCSS,{content:e,confirmUrl:this.state_manager.buildConfirmEndpointURI(),onConfirm:this.state_manager.onConfirm,useDig2:this.props.useDig2}),r.default.createElement("div",{className:"sub-nav chat-bubble header-bubble upsell-bubble",id:"upsell-bubble"},r.default.createElement("div",{className:n},o,r.default.createElement("div",{className:"chat-bubble-arrow-border"}),r.default.createElement("div",{className:"chat-bubble-arrow"}))))},t.displayName="HeaderBubbleWithoutCSS",t})(s.PromptLocationWithDefaultState);t.HeaderBubbleWithoutCSS=_,t.HeaderBubble=a.requireCssWithComponent(_,["/static/css/upsell/prompt_pagelet-vflFaykv3.css","/static/css/dig-components/index.web-vflyKkT3N.css"])})),define("modules/clean/react/prompt/header_link",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/prompt/prompt_location","modules/clean/react/sprite_div","modules/clean/static_urls","dig-components/icons","dig-components/icons/src","dig-components/typography"],(function(e,t,n,r,o,i,a,s,l,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importDefault(a);var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getDig2Icon=function(){var e=t.props.content,n=void 0;return e.linkIcon&&("s_briefcase"===e.linkIcon?n=r.default.createElement("img",{src:s.static_url("/static/images/upsell/dig/s_briefcase-vflrvBSTA.svg")}):"star_upgrade"===e.linkIcon&&(n=r.default.createElement(l.UIIcon,{src:c.UpgradeLine}))),void 0===n?void 0:r.default.createElement("div",{className:"nav-link-icon"},n)},t.getPretext=function(){var e=t.props.content;if(e.linkPretext)return r.default.createElement("div",{className:"nav-link-pretext"},r.default.createElement(p.Text,null,e.linkPretext))},t.dig2Render=function(){var e=t.props.content,n=t.getDig2Icon(),o=t.getPretext(),i=r.default.createElement("div",{ref:t.props.linkRef},r.default.createElement(p.Link,{className:"confirm-button",href:e.confirmUrl,onClick:t.props.onConfirm,hasNoUnderline:!0},e.linkText));return r.default.createElement("div",{className:"nav-link-dig2"},n,o,i)},t.deprecatedRender=function(){var e,n=t.props.content,o=["confirm-button","header-nav-link","enabled"];n.linkPretext&&o.push("header-nav-link--bold");var i=e=n.linkIcon?r.default.createElement("a",{className:o.join(" "),href:t.props.confirmUrl,onClick:t.props.onConfirm},r.default.createElement(a.default,{group:"web",name:n.linkIcon,text:n.linkText})):r.default.createElement("a",{className:o.join(" "),href:t.props.confirmUrl,onClick:t.props.onConfirm},n.linkText);return n.linkPretext&&(i=r.default.createElement("div",{className:"header-nav-link--space"},r.default.createElement("span",{className:"header-link__pretext"},n.linkPretext),e)),r.default.createElement("div",{className:"header-link"},i)},t}return n.__extends(t,e),t.prototype.render=function(){return this.props.useDig2?this.dig2Render():this.deprecatedRender()},t.displayName="HeaderLinkRendererWithoutCSS",t})(r.default.Component);t.HeaderLinkRendererWithoutCSS=m;var d=o.requireCssWithComponent(m,["/static/css/upsell/prompt_pagelet-vflFaykv3.css","/static/css/dig-components/index.web-vflyKkT3N.css"]),u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.state_manager.onShow()},t.prototype.render=function(){return r.default.createElement("li",{className:"top-level-nav-item"},r.default.createElement(d,{content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),onConfirm:this.state_manager.onConfirm,useDig2:this.props.useDig2}))},t})(i.PromptLocationWithDefaultState);t.HeaderLink=u})),define("modules/clean/react/prompt/home_modal",["require","exports","tslib","react","classnames","modules/clean/react/css","modules/clean/react/modal","modules/clean/upsell/prompt_event_logger","modules/clean/user_education/user_education_loader","modules/clean/ux_analytics_utils","dig-components/buttons","dig-components/modal","dig-components/typography","modules/clean/react/prompt/non_dig_home_modal","modules/clean/react/prompt/prompt_button","modules/clean/react/prompt/home_modal_base"],(function(e,t,n,r,o,i,a,s,l,c,p,m,d,u,f,g){"use strict";function _(e){return f.PromptButton(e)}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importDefault(o);var h=(function(e){function o(o){var i=e.call(this,o)||this;if(t.HomeModal.shouldDisplayHomeModal(o)){if(!i.props.useDig2){var s=r.default.createElement(u.NonDigHomeModal,n.__assign({},o,{ref:o.refCallback}));a.Modal.showInstance(s)}}else t.HomeModal.kickstartOnboarding(o),i.props.refCallback&&i.props.refCallback(null);return i}return n.__extends(o,e),o.prototype.render=function(){if(this.props.useDig2&&t.HomeModal.shouldDisplayHomeModal(this.props)){if(!a.Modal.isModalDisplayed())return r.default.createElement(v,n.__assign({},this.props));new s.PromptEventLogger(this.props).recordEvent("home_modal_suppressed_by_other_modal")}return null},o.shouldDisplayHomeModal=function(e){return!(!e||!e.campaign)&&!(e.campaign.isHomeOnboardingEnabled&&e.campaign.onboardingModuleName&&-1===["home_v1","home_v0"].indexOf(e.campaign.onboardingModuleName))},o.kickstartOnboarding=function(e){if(e&&e.campaign){e.campaign.onboardingModuleName?(l.UELoader.notifyModuleToLoad(e.campaign.onboardingModuleName),g.notifyMaestroOnboardingShown(e.campaign.onboardingModuleName),g.notifyMaestroOnboardingConfirmClick(e.campaign.onboardingModuleName)):l.UELoader.notifyModuleToLoad(null);var t=new s.PromptEventLogger(e);t.recordClientImpression(),t.recordConfirm(),t.recordEvent("onboarding_confirmed_no_prompt")}else l.UELoader.notifyModuleToLoad(null)},o.displayName="HomeModalWrapper",o})(r.default.PureComponent);t.HomeModalWrapper=h;var v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.close=function(){c.dispatchModalClosed()},t.prototype.isImageFirstModal=function(){return"image-first-modal"===this.props.campaign.content.modalStyle},t.prototype.getImageClasses=function(){var e=this.props.campaign.content.imageStyle;return o.default({"image-container":!0,"image-first":this.isImageFirstModal(),"inline-image":!this.isImageFirstModal(),"spot-image":"large"!==e,"hero-image":"large"===e})},t.prototype.componentDidMount=function(){this.onShow()},t.prototype.render=function(){var e=this.props.previewContextId,t={},o=void 0;e&&(t={shouldFocusAfterRender:!1,shouldReturnFocusAfterClose:!1,parentSelector:function(){return document.getElementById(e)}},o=r.default.createElement("div",{className:"sizing-placeholder prompt-modal-dig"},this.renderHeader(),this.renderBody(),this.renderFooter()));var i=!this.state.isDismissed&&!this.state.isConfirmed;return r.default.createElement(r.default.Fragment,null,r.default.createElement(m.Modal,n.__assign({className:"prompt-modal-dig",open:i,withCloseButton:this.isImageFirstModal()?void 0:"Close",onRequestClose:this.onDismiss},t),this.renderHeader(),this.renderBody(),this.renderFooter()),o)},t.prototype.renderHeader=function(){var e=void 0;return this.isImageFirstModal()&&(e=r.default.createElement("div",{className:this.getImageClasses()},this.renderImage())),r.default.createElement(r.default.Fragment,null,e,r.default.createElement(m.Modal.Header,{hasBottomSpacing:"title-standard"},r.default.createElement(d.Title,null,this.props.campaign.content.title)))},t.prototype.renderBody=function(){var e=void 0;return this.isImageFirstModal()||(e=r.default.createElement("div",{className:this.getImageClasses()},this.renderImage())),this.isImageFirstModal()?r.default.createElement(m.Modal.Body,{hasVerticalSpacing:!1},this.renderSubtext(),this.renderBottomText()):r.default.createElement(r.default.Fragment,null,e,r.default.createElement(m.Modal.Body,{hasVerticalSpacing:!1},this.renderSubtext(),this.renderBottomText()))},t.prototype.renderFooter=function(){var e=void 0;this.props.campaign.content.confirmText&&(e=r.default.createElement(_,{variant:"primary",text:this.props.campaign.content.confirmText,url:this.props.campaign.content.confirmUrl,confirmInNewTab:this.props.campaign.content.confirmInNewTab,confirmIsPost:this.props.campaign.content.confirmIsPost,stateManager:this.state_manager,onClick:this.onConfirm}));var t=void 0;this.props.campaign.content.cancelText&&(this.props.campaign.content.useSecondaryButtonAsLink?this.props.campaign.content.secondaryUrl&&(t=r.default.createElement(_,{variant:"opacity",text:this.props.campaign.content.cancelText,url:this.props.campaign.content.secondaryUrl,confirmInNewTab:this.props.campaign.content.confirmInNewTab,confirmIsPost:this.props.campaign.content.confirmIsPost,stateManager:this.state_manager,onClick:this.onConfirm})):t=r.default.createElement(p.Button,{className:"dismiss-button prompt-button",variant:"opacity",onClick:this.onDismiss},this.props.campaign.content.cancelText));var n=void 0;return this.props.campaign.content.tertiaryText&&this.props.campaign.content.tertiaryUrl?n=r.default.createElement(_,{variant:"transparent",text:this.props.campaign.content.tertiaryText,url:this.props.campaign.content.tertiaryUrl,confirmInNewTab:this.props.campaign.content.confirmInNewTab,confirmIsPost:this.props.campaign.content.confirmIsPost,stateManager:this.state_manager,onClick:this.onConfirm}):this.props.campaign.content.remindMeLaterText&&(n=r.default.createElement(p.Button,{className:"remind-me-later prompt-button",variant:"transparent",onClick:this.onRemindMeLater},this.props.campaign.content.remindMeLaterText)),r.default.createElement(m.Modal.Footer,{className:"prompt-buttons"},n,t,e,this.renderBottomText())},t})(g.HomeModalBase);t.DigHomeModal=v,t.HomeModal=i.requireCssWithComponent(h,["/static/css/modal-vflp8UKYY.css","/static/css/upsell/prompt_pagelet-vflFaykv3.css","/static/css/upsell/upsell_modal-vfl9AZTCJ.css"])})),define("modules/clean/upsell/exception",["require","exports","tslib","modules/core/exception","modules/core/xhr"],(function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.SEVERITY=r.SEVERITY,t.TAGS={MEGAPHONE:"megaphone",PROMPT:"prompt",PROMPT_ADMIN:"prompt-admin",PROMPT_INIT:"prompt-init",LEGACY_TOP_NOTIFICATIONS:"legacy-top-notifications"},t.logExceptionRate=function(e){var t=e.severity,n=void 0===t?r.SEVERITY.CRITICAL:t;o.sendXhr("/prompt/log_jse",{severity:n})},t.reportException=function(e){var n=e.err,o=e.tags,i=void 0===o?[]:o,a=e.severity,s=void 0===a?r.SEVERITY.CRITICAL:a,l=e.exc_extra,c=void 0===l?{}:l;i.push(t.TAGS.PROMPT),i.push(t.TAGS.MEGAPHONE),r.reportException({err:n,tags:i,severity:s,exc_extra:c}),t.logExceptionRate({severity:s})},t.reportJsControllerException=function(e){var n=e.err,o=e.js_controller_options,i=void 0===o?{}:o,a=e.severity,s=void 0===a?r.SEVERITY.CRITICAL:a,l=e.tags,c=void 0===l?[]:l,p={"campaign-name":"campaignName",location:"campaignLocationId"};for(var m in p)if(p.hasOwnProperty(m)){var d=i[p[m]];d&&c.push("prompt-"+m+"-"+d)}t.reportException({err:n,tags:c,severity:s,exc_extra:i})}})),define("modules/clean/upsell/upsell_controller",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/upsell/exception","modules/clean/upsell/legacy_prompt_event_logging","modules/core/dom","modules/core/uri"],(function(e,t,n,r,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importStar(o),i=n.__importStar(i),s=n.__importStar(s);var c=(function(){function e(t,n,o){var i=this;this._keydown=this._keydown.bind(this),this.dismiss=this.dismiss.bind(this),this.confirm=this.confirm.bind(this),this.post_dismiss=this.post_dismiss.bind(this),this.post_confirm=this.post_confirm.bind(this),this.options=o,t.length>0&&t.one("click",(function(e){return i.confirm(e)})),n.length>0&&n.one("click",(function(e){var t=r.default(e.target).hasClass("remind-me-later");return i.dismiss(e,t)})),this.options.dismissWithKeys&&r.default(document).on("keydown",this._keydown),e.add_tk_params(t,{addTkParams:this.options.addTkParams,campaignId:this.options.campaignId,versionId:this.options.versionId,campaignLocationTkId:this.options.campaignLocationTkId}),t.add(n).addClass("enabled")}return e.initClass=function(){this.CONFIRM="confirm",this.DISMISS="dismiss",this.LOG_IMPRESSION="log_impression"},e.prototype._keydown=function(e){if(27===e.keyCode||8===e.keyCode&&!s.focus_in_input())return e.preventDefault(),r.default(document).off("keydown",this._keydown),this.dismiss(e)},e.prototype._campaignUrl=function(t,n){var r=t===e.CONFIRM?"/prompt/confirm":t===e.DISMISS?"/prompt/dismiss":t===e.LOG_IMPRESSION?"/prompt/log_impression":void 0;if(this.options&&this.options.campaignId){var o=new l.URI({path:r}).updateQuery({campaign_id:this.options.campaignId});return this.options.versionId&&o.updateQuery({campaign_id:this.options.versionId,version_id:this.options.versionId}),t===e.DISMISS&&n&&o.updateQuery({remind_me_later:!0}),o.toString()}},e.prototype._confirmOrDismiss=function(e,t,n,i){var a=this;return"keydown"===e.type||n||(e.stopImmediatePropagation(),e.preventDefault()),o.SilentBackgroundRequest({type:"POST",url:t,subject_user:this.options.activeUserId||this.options.subjectUser,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}}).done((function(t){return"keydown"===e.type||n||e.target.click(),r.default(document).trigger(i,a.options)}))},e.prototype.dismiss=function(t,n){var o=this._campaignUrl(e.DISMISS,n);return o&&this._confirmOrDismiss(t,o,!1,"db:prompt:dismiss"),r.default(document).trigger("db:prompt:pre-dismiss",this.options)},e.prototype.confirmUrl=function(e){var t=r.default(e.currentTarget);return(t.is("button, input")&&"submit"===t.attr("type")?r.default(e.currentTarget).closest("form").attr("action"):t.is("a")?r.default(e.currentTarget).attr("href"):void 0)||this.options.confirmUrl},e.prototype.confirmInNewTab=function(e){var t=r.default(e.currentTarget),n=t.is("button, input")&&"submit"===t.attr("type")?r.default(e.currentTarget).closest("form").attr("target"):t.is("a")?r.default(e.currentTarget).attr("target"):void 0;return n?"_blank"===n:this.options.confirmInNewTab},e.prototype.confirm=function(t){var n=this._campaignUrl(e.CONFIRM);return n&&this._confirmOrDismiss(t,n,this.confirmInNewTab(t),"db:prompt:confirm"),r.default(document).trigger(a.LEGACY_EVENT_PRE_CONFIRM,this.options)},e.prototype.get_time_since_request_start=function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?(new Date).getTime()-window.performance.timing.navigationStart:void 0},e.prototype.log_impression=function(){var t=this._campaignUrl(e.LOG_IMPRESSION);if(t)return o.SilentBackgroundRequest({type:"POST",url:t,subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.prototype.log_event=function(e){if(this.options&&this.options.campaignId){var t=new l.URI({path:"/prompt/log_event"}).updateQuery({event_name:e,campaign_id:this.options.campaignId});return this.options.versionId&&t.updateQuery({campaign_id:this.options.versionId,version_id:this.options.versionId}),o.SilentBackgroundRequest({type:"POST",url:t.toString(),subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})}},e.prototype.post_dismiss=function(){var e=this._dismissUrl();if(e)return o.SilentBackgroundRequest({type:"POST",url:e,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.prototype.post_confirm=function(){var e=this._confirmUrl();if(e)return o.SilentBackgroundRequest({type:"POST",url:e,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.add_tk_params=function(e,t){if(t.addTkParams){if(t.campaignId&&t.campaignLocationTkId)return e.each((function(e,n){var o,i=r.default(n);i.is("a")?o="href":(i=i.closest("form"),o="action");var a=i.attr(o);if(i.length>0&&a){var s=l.URI.parse(a);return s.updateQuery({_tk:t.campaignLocationTkId,_camp:t.versionId||t.campaignId}),i.attr(o,s.toString())}}));var n=new Error("Missing campaignId or campaignLocationTkId.");i.reportJsControllerException({err:n,js_controller_options:t,severity:i.SEVERITY.NONCRITICAL})}},e.register_custom_controller=function(e){var t=e.on_show,n=e.on_confirm,o=e.on_dismiss,i=e.pre_confirm,s=e.pre_dismiss;if(t&&r.default(document).on(a.LEGACY_EVENT_SHOW,t),n&&r.default(document).on(a.LEGACY_EVENT_CONFIRM,n),o&&r.default(document).on(a.LEGACY_EVENT_DISMISS,o),i&&r.default(document).on(a.LEGACY_EVENT_PRE_CONFIRM,i),s)return r.default(document).on(a.LEGACY_EVENT_PRE_DISMISS,s)},e.unregister_custom_controller=function(e){var t=e.on_show,n=e.on_confirm,o=e.on_dismiss,i=e.pre_confirm,s=e.pre_dismiss;if(t&&r.default(document).off(a.LEGACY_EVENT_SHOW,t),n&&r.default(document).off(a.LEGACY_EVENT_CONFIRM,n),o&&r.default(document).off(a.LEGACY_EVENT_DISMISS,o),i&&r.default(document).off(a.LEGACY_EVENT_PRE_CONFIRM,i),s)return r.default(document).off(a.LEGACY_EVENT_PRE_DISMISS,s)},e})();c.initClass(),t.default=c})),define("modules/clean/upsell/prompt_event_logger",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/upsell/legacy_prompt_event_logging"],(function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importStar(o);var a=(function(){function e(e){this.campaignProps=e}return e.prototype.recordClientImpression=function(){var e=this.getUpsellControllerURI("/prompt/log_impression");this.recordAck(e)},e.prototype.recordConfirm=function(){var e=this.getUpsellControllerURI("/prompt/confirm");this.recordAck(e,"db:prompt:confirm")},e.prototype.recordDismiss=function(e){var t=this.getUpsellControllerURI("/prompt/dismiss",{remindMeLater:e});this.recordAck(t,"db:prompt:dismiss")},e.prototype.recordEvent=function(e){var t=this.getUpsellControllerURI("/prompt/log_event",{eventName:e});this.recordAck(t)},e.prototype.recordAck=function(e,t){var n=this;o.SilentBackgroundRequest({type:"POST",url:e.toString()}).done((function(e){t&&n.triggerExternalEvent(t)}))},e.prototype.getUpsellControllerURI=function(e,t){return i.getUpsellControllerURI(e,{campaignId:this.campaignProps.campaign.campaignId,versionId:this.campaignProps.campaign.versionId,activeUserId:this.campaignProps.subjectUser,promptQueriedAtMs:this.campaignProps.promptQueriedAtMs,requestId:this.campaignProps.requestId,csrfToken:this.campaignProps.csrfToken,csrfTokenType:this.campaignProps.csrfTokenType,eventName:t&&t.eventName,remindMeLater:t&&t.remindMeLater})},e.prototype.triggerExternalEvent=function(e){r.default(document).trigger(e,{campaignName:this.campaignProps.campaign.campaignName})},e})();t.PromptEventLogger=a}));
//# sourceMappingURL=pkg-prompt.min.js-vfl5P0Zvc.map